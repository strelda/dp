(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     63895,       1540]
NotebookOptionsPosition[     60076,       1472]
NotebookOutlinePosition[     60411,       1487]
CellTagsIndexPosition[     60368,       1484]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Inicialize some functions", "Section",
 CellChangeTimes->{{3.826384236370326*^9, 
  3.82638424998965*^9}},ExpressionUUID->"3f7e1bf1-67b3-4e98-b2b0-\
2eac7608b588"],

Cell[BoxData[
 RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellLabel->
  "In[134]:=",ExpressionUUID->"742f1702-d7ea-459a-a834-c38fe42c2084"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"<<", "CompiledFunctionTools`"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<NumericalCalculus`\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ParallelNeeds", "[", "\"\<NumericalCalculus`\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileOptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
     RowBox[{"RuntimeOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<EvaluateSymbolically\>\"", "\[Rule]", "False"}], ",", 
        RowBox[{"\"\<CatchMachineUnderflow\>\"", "\[Rule]", "False"}], ",", 
        RowBox[{"\"\<CatchMachineOverflow\>\"", "\[Rule]", "False"}]}], 
       "}"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileOptionsPar", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
     RowBox[{"RuntimeAttributes", "\[Rule]", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"font", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"FontSize", "\[Rule]", "12"}], "]"}]}], ",", 
     RowBox[{"AxesStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"FontSize", "\[Rule]", "12"}], "]"}]}], ",", 
     RowBox[{"TicksStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"FontSize", "\[Rule]", "12"}], "]"}]}], ",", 
     RowBox[{"LabelStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Latin Modern Roman\>\""}], ",", 
        
        RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], "}"}]}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", "texStyle"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"densityPlotOptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<\[Lambda]\>\"", ",", "\"\<\[Chi]\>\""}], "}"}]}], ",", 
     RowBox[{"Evaluate", "@", "font"}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", "\"\<SunsetColors\>\""}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.826001345692895*^9, 3.826001348605947*^9}, {
   3.8260139995791492`*^9, 3.826013999879569*^9}, {3.82601594953941*^9, 
   3.826015949819188*^9}, {3.826018339604105*^9, 3.826018339889323*^9}, {
   3.8261181110860233`*^9, 3.826118114942244*^9}, {3.826814273659827*^9, 
   3.82681428638478*^9}, {3.827160137394628*^9, 3.827160161030387*^9}, 
   3.827305306890033*^9, {3.827305406683405*^9, 3.827305431549193*^9}, {
   3.8273170751859713`*^9, 3.827317075466571*^9}, 3.827413622582594*^9, 
   3.827481614472765*^9, {3.829230810389687*^9, 3.829230813126457*^9}, 
   3.829230866178368*^9, {3.829617957479067*^9, 
   3.829617988965953*^9}},ExpressionUUID->"ac2ab778-8cd4-4fed-9175-\
bb82b0360369"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["First order perturbation Hamiltonian", "Chapter"]], \
"Section",
 CellChangeTimes->{{3.826016188132229*^9, 3.8260162092821083`*^9}, {
  3.826119184120637*^9, 
  3.826119191218803*^9}},ExpressionUUID->"67109e61-46c7-498d-a511-\
837ee58c2df1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Lambda]", "\[Element]", "Reals"}], ",", 
     RowBox[{"\[Chi]", "\[Element]", "Reals"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.826016881006897*^9, 3.8260168911810923`*^9}, {
   3.8261141474854403`*^9, 3.82611416004382*^9}, 3.8267806944634323`*^9},
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[143]:=",ExpressionUUID->"42ba692e-ef03-4759-9c97-7c9f7c114aef"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Delta]", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"KroneckerDelta", "[", 
    RowBox[{"a", ",", "b"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Je", "[", 
    RowBox[{"sn_", ",", "j_", ",", "m_"}], "]"}], ":=", 
   SqrtBox[
    RowBox[{
     RowBox[{"j", 
      RowBox[{"(", 
       RowBox[{"j", "+", "1"}], ")"}]}], "-", 
     RowBox[{"m", 
      RowBox[{"(", 
       RowBox[{"m", "+", 
        RowBox[{"sn", " ", "1"}]}], ")"}]}]}]]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8259986497553263`*^9, 3.825998672604487*^9}, {
   3.8259992399132967`*^9, 3.825999321050805*^9}, 3.8259993623614607`*^9, {
   3.825999464925118*^9, 3.8259994658587723`*^9}, {3.826785390512155*^9, 
   3.8267854380515547`*^9}},
 CellLabel->
  "In[144]:=",ExpressionUUID->"238d529a-9c63-4108-9241-a6f9de282367"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"V1", "[", 
   RowBox[{"jp_", ",", "mp_", ",", "j_", ",", "m_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", "4"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Je", "[", 
       RowBox[{"1", ",", "j", ",", 
        RowBox[{"m", "+", "1"}]}], "]"}], 
      RowBox[{"Je", "[", 
       RowBox[{"1", ",", "j", ",", "m"}], "]"}], 
      RowBox[{"\[Delta]", "[", 
       RowBox[{"mp", ",", 
        RowBox[{"m", "+", "2"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"Je", "[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "j", ",", 
        RowBox[{"m", "-", "1"}]}], "]"}], 
      RowBox[{"Je", "[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "j", ",", "m"}], "]"}], 
      RowBox[{"\[Delta]", "[", 
       RowBox[{"mp", ",", 
        RowBox[{"m", "-", "2"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"\[Delta]", "[", 
       RowBox[{"mp", ",", "m"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Je", "[", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "j", ",", "m"}], "]"}], 
         RowBox[{"Je", "[", 
          RowBox[{"1", ",", "j", ",", 
           RowBox[{"m", "-", "1"}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Je", "[", 
          RowBox[{"1", ",", "j", ",", "m"}], "]"}], 
         RowBox[{"Je", "[", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "j", ",", 
           RowBox[{"m", "+", "1"}]}], "]"}]}]}], " ", ")"}]}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V2", "[", 
   RowBox[{"jp_", ",", "mp_", ",", "j_", ",", "m_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"m", "+", "j"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Je", "[", 
        RowBox[{"1", ",", "j", ",", "m"}], "]"}], 
       RowBox[{"\[Delta]", "[", 
        RowBox[{"mp", ",", 
         RowBox[{"m", "+", "1"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"Je", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "j", ",", "m"}], "]"}], 
       RowBox[{"\[Delta]", "[", 
        RowBox[{"mp", ",", 
         RowBox[{"m", "-", "1"}]}], "]"}]}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"m", "+", "1", "+", "j"}], ")"}], 
    RowBox[{"Je", "[", 
     RowBox[{"1", ",", "j", ",", "m"}], "]"}], 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"mp", ",", 
      RowBox[{"m", "+", "1"}]}], "]"}]}], "+", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"m", "-", "1", "+", "j"}], ")"}], 
    RowBox[{"Je", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "j", ",", "m"}], "]"}], 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"mp", ",", 
      RowBox[{"m", "-", "1"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V3", "[", 
   RowBox[{"jp_", ",", "mp_", ",", "j_", ",", "m_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"\[Delta]", "[", 
    RowBox[{"mp", ",", "m"}], "]"}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"j", "+", "m"}], ")"}], "2"]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hd", "[", 
   RowBox[{"jp_", ",", "mp_", ",", "j_", ",", "m_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"m", " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"jp", ",", "j"}], "]"}], 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"mp", ",", "m"}], "]"}]}], "-", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Delta]", "[", 
      RowBox[{"jp", ",", "j"}], "]"}], 
     RowBox[{"2", "j"}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Lambda]", " ", 
       RowBox[{"V1", "[", 
        RowBox[{"jp", ",", "mp", ",", "j", ",", "m"}], "]"}]}], "+", 
      RowBox[{"\[Chi]", " ", 
       RowBox[{"V2", "[", 
        RowBox[{"jp", ",", "mp", ",", "j", ",", "m"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["\[Chi]", "2"], 
       RowBox[{"V3", "[", 
        RowBox[{"jp", ",", "mp", ",", "j", ",", "m"}], "]"}]}]}], 
     ")"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.825998224534062*^9, 3.825998405469041*^9}, {
   3.825998550619458*^9, 3.8259986375936413`*^9}, {3.825998676545611*^9, 
   3.825998751336893*^9}, {3.825998786526939*^9, 3.825998954315954*^9}, {
   3.825999023109066*^9, 3.825999023359281*^9}, 3.825999133747304*^9, 
   3.825999166186602*^9, {3.8259992103558817`*^9, 3.8259992262577887`*^9}, 
   3.825999410725338*^9, {3.825999481715238*^9, 3.825999492911231*^9}, {
   3.826000566993601*^9, 3.8260005705463123`*^9}, {3.826002809665291*^9, 
   3.826002810780651*^9}, {3.826002905483427*^9, 3.8260029414279823`*^9}, {
   3.82600913393906*^9, 3.8260091424566402`*^9}, 3.826009176683318*^9, 
   3.826009993816455*^9, {3.826269356423053*^9, 3.826269359486989*^9}, {
   3.826781103000942*^9, 3.826781104147229*^9}, 3.826781134973575*^9, {
   3.826781309839685*^9, 3.8267813528773623`*^9}, {3.826781899244912*^9, 
   3.826781997115054*^9}, {3.826782093318408*^9, 3.8267821240732203`*^9}, {
   3.8267821888273582`*^9, 3.8267822089563103`*^9}, {3.826782383581203*^9, 
   3.826782423615696*^9}, {3.826785167962628*^9, 3.826785204023613*^9}, {
   3.826786182869647*^9, 3.826786191668026*^9}, {3.826786242206399*^9, 
   3.82678624274267*^9}},
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[146]:=",ExpressionUUID->"25d91350-2c5c-4f3f-b989-79cf79f4d75e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nn", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"jj", "=", 
    RowBox[{"nn", "/", "2"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dim", "=", 
   RowBox[{"nn", "+", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"mp_", ",", "m_"}], "]"}], ":=", 
   RowBox[{"Hd", "[", 
    RowBox[{"jj", ",", "mp", ",", "jj", ",", "m"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HH", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"mp", ",", "m"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"mp", ",", 
       RowBox[{"-", "jj"}], ",", "jj"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", 
       RowBox[{"-", "jj"}], ",", "jj"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H", "[", 
    RowBox[{"\[Lambda]_", ",", "\[Chi]_"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"mp", ",", "m"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"mp", ",", 
       RowBox[{"-", "jj"}], ",", "jj"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", 
       RowBox[{"-", "jj"}], ",", "jj"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Lambda]", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Chi]", ",", "_Real"}], "}"}]}], "}"}], ",", 
     RowBox[{"Evaluate", "@", "HH"}], ",", 
     RowBox[{"Evaluate", "@", "compileOptions"}]}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.825999808451119*^9, 3.8259999610816708`*^9}, {
   3.826000016975996*^9, 3.82600021542994*^9}, {3.826000301558736*^9, 
   3.826000356752215*^9}, {3.826000476089918*^9, 3.826000489009012*^9}, 
   3.826000606480093*^9, {3.826001248142696*^9, 3.826001253228297*^9}, {
   3.826002813122592*^9, 3.826002816305376*^9}, {3.826007215470689*^9, 
   3.8260072491426573`*^9}, {3.826007733027317*^9, 3.826007839159418*^9}, {
   3.82600804031494*^9, 3.826008040724723*^9}, 3.826008724291765*^9, {
   3.8260088027080507`*^9, 3.8260088143722773`*^9}, {3.826009110457657*^9, 
   3.8260091902578373`*^9}, {3.826014975056283*^9, 3.826014981764826*^9}, 
   3.826015225251341*^9, {3.8260182055850687`*^9, 3.826018227392696*^9}, 
   3.82625340451791*^9, {3.82625429365051*^9, 3.826254296472508*^9}, {
   3.826269267381939*^9, 3.826269267586198*^9}, 3.8262742705075274`*^9, 
   3.826274836707177*^9, 3.8262845970554237`*^9, {3.826286010013372*^9, 
   3.826286010555134*^9}, 3.8262915480877323`*^9, {3.826376529555462*^9, 
   3.826376531981254*^9}, {3.8267049725035563`*^9, 3.826704975305242*^9}, 
   3.826706911880579*^9, {3.826770600646803*^9, 3.826770603175046*^9}, 
   3.8267715508219557`*^9, {3.8267801996793003`*^9, 3.826780203628392*^9}, {
   3.8267803392925797`*^9, 3.82678034218423*^9}, {3.82678038867212*^9, 
   3.826780416786552*^9}, 3.8267804785045013`*^9, {3.826781371568959*^9, 
   3.8267813795691223`*^9}, 3.8267814314774523`*^9, {3.82678240284226*^9, 
   3.826782453442974*^9}, {3.826782715112446*^9, 3.82678275928166*^9}, {
   3.8267845876157703`*^9, 3.826784587919712*^9}, {3.826785971199977*^9, 
   3.826785975622019*^9}, 3.826786319984289*^9, {3.826786356672811*^9, 
   3.826786357594757*^9}, 3.826787515011897*^9, {3.8267876081173887`*^9, 
   3.826787622031723*^9}, 3.826787732501113*^9, {3.826795431856983*^9, 
   3.8267954341664047`*^9}, {3.826813520299404*^9, 3.826813626309408*^9}, {
   3.826813723194812*^9, 3.826813844003036*^9}, {3.826813880992138*^9, 
   3.82681393839599*^9}, {3.8268139853680696`*^9, 3.826814025311205*^9}, {
   3.826814076634532*^9, 3.82681407936908*^9}, {3.8268141795755796`*^9, 
   3.826814197534822*^9}, {3.826814229660845*^9, 3.826814256217836*^9}, {
   3.82681479522786*^9, 3.826814797802899*^9}, {3.826814971697074*^9, 
   3.826815011612728*^9}, 3.826815144613723*^9, 3.82688603610061*^9, {
   3.826887331474918*^9, 3.826887342182266*^9}, {3.8269002710033503`*^9, 
   3.826900280598322*^9}, 3.82694500071731*^9, 3.826945036248962*^9, 
   3.8269450736769953`*^9, {3.826967084133108*^9, 3.826967085422016*^9}, 
   3.827218568783897*^9, {3.827220773523451*^9, 3.8272207926931353`*^9}, 
   3.8273048596058073`*^9, {3.827310514312155*^9, 3.8273105145169163`*^9}, {
   3.827311661801855*^9, 3.8273116647496347`*^9}, 3.827311921694487*^9, {
   3.827312108142475*^9, 3.827312110013277*^9}, 3.827423249200803*^9, 
   3.827423289296424*^9, {3.827465368704151*^9, 3.827465384717678*^9}, {
   3.827465990442677*^9, 3.8274659905644484`*^9}, 3.827466149593614*^9, {
   3.8274678268909073`*^9, 3.8274678422637043`*^9}, 3.82746799060891*^9, 
   3.827468095048594*^9, {3.82750362195304*^9, 3.827503623104054*^9}, {
   3.828020310034705*^9, 3.828020310403193*^9}, 3.828020687678133*^9, 
   3.8280213286930428`*^9, 3.829056595987739*^9, {3.8290566466539516`*^9, 
   3.8290566531146584`*^9}, 3.829057133041896*^9, 3.829284208370618*^9, 
   3.829284320898837*^9, {3.829572294540209*^9, 3.8295722966748238`*^9}, {
   3.8295723322759037`*^9, 3.8295723325290527`*^9}, {3.829578954009701*^9, 
   3.829578955400098*^9}, 3.8295790811326323`*^9, {3.829579120385054*^9, 
   3.8295791519386473`*^9}, {3.8295792429705973`*^9, 3.829579244863649*^9}, 
   3.8295792857034197`*^9, 3.82957935471241*^9, 3.829579514741317*^9},
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[150]:=",ExpressionUUID->"523b20e6-2551-4989-a8b3-b75182c1be1c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"ConjugateTranspose", "@", 
     RowBox[{"H", "[", 
      RowBox[{"2", ",", "7"}], "]"}]}], "\[Equal]", 
    RowBox[{"H", "[", 
     RowBox[{"2", ",", "7"}], "]"}]}], ",", 
   RowBox[{"Print", "[", "\"\<Probably is Hermitean\>\"", "]"}], ",", 
   RowBox[{"Print", "[", "\"\<THIS IS NOT Hermitean\>\"", "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8260102123327627`*^9, 3.826010392321637*^9}, {
   3.826015004116428*^9, 3.826015023614376*^9}, {3.826376535621965*^9, 
   3.826376537921674*^9}, {3.826388820047048*^9, 3.8263888253027554`*^9}, {
   3.826780377255237*^9, 3.8267803796517353`*^9}, {3.826782229295322*^9, 
   3.826782260108252*^9}, {3.82678229349629*^9, 3.826782399128501*^9}, {
   3.826813645916296*^9, 3.826813708552185*^9}, {3.826813946381761*^9, 
   3.8268139530260887`*^9}, 3.826814099101132*^9, {3.826814211785392*^9, 
   3.826814221571555*^9}, 3.826814894589082*^9, {3.826815025527907*^9, 
   3.826815030035215*^9}, {3.8272207567717037`*^9, 3.827220758404917*^9}, 
   3.8295723289694157`*^9},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[157]:=",ExpressionUUID->"588a8161-55a8-4c8d-9c71-379a153199a6"],

Cell[BoxData["\<\"Probably is Hermitean\"\>"], "Print",
 CellChangeTimes->{{3.826814884563307*^9, 3.826814895102754*^9}, {
   3.826815018863085*^9, 3.826815030404848*^9}, 3.826816751125478*^9, 
   3.8268169946994047`*^9, 3.8268192389789753`*^9, 3.826823310187644*^9, 
   3.8268547234524393`*^9, 3.8268860466983023`*^9, {3.826887337021453*^9, 
   3.826887345901175*^9}, 3.8269412384775543`*^9, {3.826944988422041*^9, 
   3.826945004292218*^9}, 3.826945080546629*^9, 3.82694622172474*^9, 
   3.826947501756659*^9, 3.8269671020120983`*^9, 3.827218574438345*^9, 
   3.827220510384615*^9, 3.827220799915167*^9, 3.827304851476418*^9, 
   3.827305326338118*^9, {3.827305386948429*^9, 3.827305435068902*^9}, 
   3.827307071095091*^9, 3.8273105277066603`*^9, 3.8273119335017557`*^9, 
   3.827312114692092*^9, 3.8273127634628477`*^9, 3.827316704443612*^9, 
   3.827318497240677*^9, 3.8273207241501617`*^9, 3.8273208086101294`*^9, 
   3.827324021197283*^9, 3.827324302238904*^9, 3.82732524063279*^9, 
   3.827326304334942*^9, 3.8273268866267023`*^9, 3.827330512276038*^9, 
   3.827390024817535*^9, 3.827392289337126*^9, 3.827392596827743*^9, 
   3.827392697191721*^9, 3.827413635470682*^9, 3.827418124466093*^9, 
   3.82741818080093*^9, 3.827423256474936*^9, 3.8274232985524282`*^9, 
   3.827458050395088*^9, {3.827465371949522*^9, 3.8274653871771107`*^9}, 
   3.827465993867363*^9, 3.8274661521020117`*^9, 3.8274666915533752`*^9, {
   3.827467832135737*^9, 3.827467844727663*^9}, 3.827468096859043*^9, 
   3.8274816108844643`*^9, 3.8274816499096403`*^9, 3.827502525688908*^9, 
   3.827638616578824*^9, 3.8276412468281593`*^9, 3.8276547446536818`*^9, 
   3.827983681711317*^9, 3.828005479458621*^9, 3.8280204495160713`*^9, 
   3.828020703125503*^9, 3.828021335834762*^9, 3.8280744006191177`*^9, 
   3.8280803648243723`*^9, {3.828082207809187*^9, 3.828082262971056*^9}, {
   3.8290565956065598`*^9, 3.829056598975424*^9}, 3.82905713557232*^9, 
   3.829058169762076*^9, 3.829115654466505*^9, 3.829115745376749*^9, 
   3.82919470302542*^9, 3.829229887731234*^9, 3.8295724140562162`*^9, 
   3.82957339700762*^9, 3.8295735997652273`*^9, 3.829577759275607*^9, 
   3.82957897089475*^9, 3.829579087262766*^9, {3.829579129628973*^9, 
   3.8295791587662153`*^9}, 3.829579587335112*^9},
 CellLabel->
  "During evaluation of \
In[157]:=",ExpressionUUID->"6dafcf27-97f5-4ab8-85ec-f0f5246be28c"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DH1C", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Lambda]", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Chi]", ",", "_Real"}], "}"}]}], "}"}], ",", 
     RowBox[{"Evaluate", "@", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"H", "[", 
         RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], ",", "\[Lambda]"}], 
       "]"}]}], ",", 
     RowBox[{"Evaluate", "@", "compileOptions"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DH2C", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Lambda]", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Chi]", ",", "_Real"}], "}"}]}], "}"}], ",", 
     RowBox[{"Evaluate", "@", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"H", "[", 
         RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], ",", "\[Chi]"}], 
       "]"}]}], ",", 
     RowBox[{"Evaluate", "@", "compileOptions"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gC", "[", 
   RowBox[{
    RowBox[{"\[Lambda]_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Chi]_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "enNonSort", ",", "en", ",", "eigNonSort", ",", "eig", ",", "g11", ",", 
      "g12", ",", "g22", ",", "M1", ",", "M1T", ",", "M2", ",", "M2T", ",", 
      "endif"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"enNonSort", ",", "eigNonSort"}], "}"}], "=", 
      RowBox[{"Eigensystem", "[", 
       RowBox[{
        RowBox[{"HC", "[", 
         RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], ",", 
        RowBox[{"Method", "\[Rule]", 
         RowBox[{"{", "\"\<Banded\>\"", "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"en", ",", "eig"}], "}"}], "=", 
      RowBox[{"Transpose", "@", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"enNonSort", ",", "eigNonSort"}], "}"}], "]"}], ",", 
         "First"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"M1", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{
          "eig", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "]"}], ".", 
         RowBox[{"DH1C", "[", 
          RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], ".", 
         RowBox[{
         "eig", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}]}], 
        "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"2", ",", "dim"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"M1T", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{
          "eig", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
          "]"}], ".", 
         RowBox[{"DH1C", "[", 
          RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], ".", 
         RowBox[{
         "eig", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"2", ",", "dim"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"M2", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{
          "eig", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "]"}], ".", 
         RowBox[{"DH2C", "[", 
          RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], ".", 
         RowBox[{
         "eig", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}]}], 
        "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"2", ",", "dim"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"M2T", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{
          "eig", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
          "]"}], ".", 
         RowBox[{"DH2C", "[", 
          RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], ".", 
         RowBox[{
         "eig", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"2", ",", "dim"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"endif", "=", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "en", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "-", 
           
           RowBox[{
           "en", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}]}], 
          ")"}], "2"], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"2", ",", "dim"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"g11", "=", 
      RowBox[{"Re", "@", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "M1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            RowBox[{
            "M1T", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
           ")"}], "/", 
          RowBox[{
          "endif", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"g12", "=", 
      RowBox[{"Re", "@", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "M1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            RowBox[{
            "M2T", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
           ")"}], "/", 
          RowBox[{
          "endif", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"g22", "=", 
      RowBox[{"Re", "@", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "M2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            RowBox[{
            "M2T", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
           ")"}], "/", 
          RowBox[{
          "endif", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"g11", ",", "g12"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"g12", ",", "g22"}], "}"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{
  3.827161712692525*^9, {3.8272207017828407`*^9, 3.827220715246963*^9}, {
   3.82730488340696*^9, 3.8273049143485117`*^9}, {3.827305184855137*^9, 
   3.82730524410923*^9}, 3.8273057801862793`*^9, {3.827305815078529*^9, 
   3.827305834974269*^9}, {3.8273059090628033`*^9, 3.827305982104656*^9}, {
   3.827306059196476*^9, 3.8273061320627613`*^9}, {3.827306198841289*^9, 
   3.827306256359577*^9}, {3.827306323592411*^9, 3.827306413937951*^9}, {
   3.827306445273864*^9, 3.827306545011588*^9}, {3.827306589441185*^9, 
   3.827306614561245*^9}, {3.8273066462691298`*^9, 3.827306668829555*^9}, {
   3.8273067403607397`*^9, 3.827306740584386*^9}, {3.8273068102545023`*^9, 
   3.827306839482028*^9}, {3.827307034345963*^9, 3.827307039499762*^9}, {
   3.8273071496105843`*^9, 3.8273071519699593`*^9}, {3.827307187207439*^9, 
   3.8273071946401043`*^9}, {3.827307347344317*^9, 3.827307355705879*^9}, {
   3.827307554282569*^9, 3.82730775958118*^9}, {3.827308154866024*^9, 
   3.827308215178553*^9}, {3.827308294198637*^9, 3.8273082980704*^9}, {
   3.8273084699256496`*^9, 3.827308479095413*^9}, {3.827308510271854*^9, 
   3.827308631275425*^9}, {3.8273086652642307`*^9, 3.827308718944353*^9}, {
   3.827308788860457*^9, 3.82730885485225*^9}, {3.8273089070418243`*^9, 
   3.827309291495039*^9}, {3.827309382149082*^9, 3.8273093858377953`*^9}, {
   3.827309563702977*^9, 3.827309624283564*^9}, {3.827309705473955*^9, 
   3.827309710808216*^9}, {3.827310609307166*^9, 3.82731061402277*^9}, {
   3.827311999750104*^9, 3.827312001722027*^9}, {3.827312055931679*^9, 
   3.827312103084041*^9}, {3.827316803253262*^9, 3.827316808081189*^9}, {
   3.827316891738356*^9, 3.827316893760168*^9}, {3.827317503122089*^9, 
   3.8273175436753817`*^9}, {3.82731762352275*^9, 3.827317706889682*^9}, {
   3.827317740417756*^9, 3.8273178136407213`*^9}, {3.827317847738551*^9, 
   3.827318099135268*^9}, {3.8273182553193693`*^9, 3.827318258412335*^9}, {
   3.8273188435009003`*^9, 3.827318862525419*^9}, {3.8273206717960777`*^9, 
   3.827320717269133*^9}, {3.8273207524714537`*^9, 3.827320767343288*^9}, {
   3.8273208006766033`*^9, 3.827320801018577*^9}, {3.827320901045168*^9, 
   3.8273210580099373`*^9}, {3.827321105106008*^9, 3.827321113643262*^9}, {
   3.82732117592171*^9, 3.827321194702812*^9}, {3.8273212334184723`*^9, 
   3.827321234319087*^9}, {3.827392298823834*^9, 3.827392299579211*^9}, {
   3.82746458760052*^9, 3.8274646679338627`*^9}, {3.827464698246986*^9, 
   3.827464729636098*^9}, {3.827464767170912*^9, 3.8274647695367117`*^9}, {
   3.8274648926679583`*^9, 3.827464923060606*^9}, {3.827465023380095*^9, 
   3.8274650316307383`*^9}, {3.82746517123528*^9, 3.827465182127418*^9}, {
   3.827465437987337*^9, 3.827465455253519*^9}, {3.827466798113122*^9, 
   3.827466819435957*^9}, {3.8274668557945967`*^9, 3.827466856042082*^9}, {
   3.827467629365638*^9, 3.827467645767269*^9}, 3.827503613432757*^9, {
   3.827506790624589*^9, 3.827506794336402*^9}, {3.8275068416035833`*^9, 
   3.827506914942028*^9}, {3.827506955995986*^9, 3.8275070203076878`*^9}, {
   3.827547976376956*^9, 3.827548014061461*^9}, {3.827549110884348*^9, 
   3.827549112876979*^9}, {3.827549271187051*^9, 3.827549293342875*^9}, 
   3.8275494833623457`*^9, {3.82754955112811*^9, 3.827549582710206*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"34845260-54b5-4b77-b773-4a52c8bb1883"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "@", 
  RowBox[{"gC", "[", 
   RowBox[{"1", ",", "1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.829573772767784*^9, 3.829573788329681*^9}},
 CellLabel->
  "In[161]:=",ExpressionUUID->"c7e6b888-a626-4dcd-9e2f-6b9dbe27ce5a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.423891`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.6725362575049318`", ",", 
       RowBox[{"-", "4.06659071612805`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4.06659071612805`"}], ",", "24.60378229638435`"}], 
      "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8295791331273823`*^9, 3.829579159350072*^9}, 
   3.8295796246064568`*^9},
 CellLabel->
  "Out[161]=",ExpressionUUID->"82ac6c9a-ed47-4964-8338-b457a40a7bc3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Energies", "Section",
 CellChangeTimes->{{3.8267846002435293`*^9, 
  3.826784603505683*^9}},ExpressionUUID->"fd819d28-3795-4351-adc3-\
62bd07895de8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"energies1", "=", 
   RowBox[{"Eigenvalues", "[", 
    RowBox[{"H", "[", 
     RowBox[{"1", ",", "\[Chi]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"energies2", "=", 
   RowBox[{"Eigenvalues", "[", 
    RowBox[{"H", "[", 
     RowBox[{"\[Lambda]", ",", "1"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.829580645724781*^9, 
  3.829580648691409*^9}},ExpressionUUID->"722dc7c3-b2b4-40ec-8d73-\
99f308a0d85f"],

Cell[BoxData[
 TemplateBox[{
  "Eigenvalues","eival",
   "\"Unable to find all roots of the characteristic polynomial.\"",2,162,2,
   16411561367162151886,"local1"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.829579947683752*^9},
 CellLabel->
  "During evaluation of \
In[162]:=",ExpressionUUID->"7797f38c-b902-4f86-835b-2d2515532220"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.829580641373909*^9},
 CellLabel->
  "Out[163]=",ExpressionUUID->"88152e11-1732-4d06-8515-557340d7cda5"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{"energies1", ",", 
   RowBox[{"{", 
    RowBox[{"\[Chi]", ",", 
     RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", "10"}], "]"}]}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "20"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Automatic", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "20"}], ",", "5"}], "}"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.829577683518619*^9, {3.829579257050609*^9, 3.829579262413897*^9}, {
   3.829579674143565*^9, 
   3.829579677800789*^9}},ExpressionUUID->"38e6c631-f2b0-411c-9d90-\
11f88873d6dc"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Plot", "[", 
   RowBox[{"energies2", ",", 
    RowBox[{"{", 
     RowBox[{"\[Lambda]", ",", 
      RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", "10"}], "]"}]}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "20"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Automatic", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "20"}], ",", "5"}], "}"}]}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.82678463131002*^9, 3.826784759847166*^9}, {
   3.826784812055591*^9, 3.8267849065677423`*^9}, {3.826784936742785*^9, 
   3.8267850420382233`*^9}, {3.82681404623771*^9, 3.826814062860506*^9}, {
   3.826814920345677*^9, 3.826814964155509*^9}, {3.826815038704659*^9, 
   3.826815039250059*^9}, {3.827220741735578*^9, 3.827220748425392*^9}, {
   3.82730499469103*^9, 3.827305002179859*^9}, {3.827466019830521*^9, 
   3.8274660246120777`*^9}, {3.8274662366345882`*^9, 3.827466243505527*^9}, {
   3.827983687034029*^9, 3.827983708586095*^9}, 3.829573506749878*^9, {
   3.82957373176237*^9, 3.829573741406476*^9}, {3.829577673318223*^9, 
   3.829577680091563*^9}, {3.8295792647785873`*^9, 
   3.829579264967702*^9}},ExpressionUUID->"d793b69e-b17f-4490-8cc9-\
17051b7a13d5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Metric tensor", "Section",
 CellChangeTimes->{{3.826016997531725*^9, 3.8260170126284857`*^9}, {
  3.827413756766926*^9, 
  3.827413757368033*^9}},ExpressionUUID->"b7f68653-2eb3-498b-9d2b-\
25b66baaab8e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"optDen", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Evaluate", "@", "densityPlotOptions"}], ",", 
     RowBox[{"PlotPoints", "\[Rule]", "20"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"DensityPlot", "[", 
    RowBox[{
     RowBox[{"ArcTan", "[", 
      RowBox[{
       RowBox[{"gC", "[", 
        RowBox[{"y", ",", "x"}], "]"}], "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "0.2"}], ",", "0.4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"Evaluate", "@", "optDen"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"DensityPlot", "[", 
    RowBox[{
     RowBox[{"ArcTan", "[", 
      RowBox[{
       RowBox[{"gC", "[", 
        RowBox[{"y", ",", "x"}], "]"}], "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "0.2"}], ",", "0.4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"Evaluate", "@", "optDen"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"DensityPlot", "[", 
    RowBox[{
     RowBox[{"ArcTan", "[", 
      RowBox[{
       RowBox[{"gC", "[", 
        RowBox[{"y", ",", "x"}], "]"}], "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "0.2"}], ",", "0.4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"Evaluate", "@", "optDen"}]}], "]"}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.827312326859331*^9, 3.827312334117145*^9}, 
   3.827317054118018*^9, {3.827464317185897*^9, 3.827464321635532*^9}, {
   3.82746446373442*^9, 3.827464469320212*^9}, {3.827465813056177*^9, 
   3.82746584143084*^9}, {3.827465889094249*^9, 3.827465896060335*^9}, {
   3.82746786593715*^9, 3.8274678807319317`*^9}, 3.827467965484816*^9, {
   3.827468003223637*^9, 3.8274680392017937`*^9}, {3.8274681030221*^9, 
   3.8274681115099792`*^9}, {3.827638723355792*^9, 3.827638729518224*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[42]:=",ExpressionUUID->"24867617-a746-45f7-aed9-3ab029b2eedc"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Metric tensor determinant", "Text"]], "Subsubsection",
 CellChangeTimes->{{3.8260162687479687`*^9, 3.8260162746596813`*^9}, 
   3.8260249318104763`*^9},
 Background->RGBColor[
  0.88, 1, 0.88],ExpressionUUID->"fbb9c723-aca4-4bfc-a861-986f6c2cd988"],

Cell[BoxData[
 RowBox[{"DensityPlot", "[", 
  RowBox[{
   RowBox[{"Det", "[", 
    RowBox[{"gC", "[", 
     RowBox[{"x", ",", "l"}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"l", ",", 
     RowBox[{"-", "1"}], ",", "2"}], "}"}], ",", 
   RowBox[{"Evaluate", "@", "densityPlotOptions"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "150"}], ",", 
   RowBox[{"ScalingFunctions", "\[Rule]", "\"\<Log10\>\""}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8260154900881653`*^9, 3.826015509525263*^9}, {
   3.8260155517803164`*^9, 3.8260156059601717`*^9}, {3.826015636014817*^9, 
   3.8260158450725822`*^9}, {3.826015912481153*^9, 3.826015924600729*^9}, {
   3.826015972215496*^9, 3.826015975544897*^9}, 3.8260173619157743`*^9, {
   3.826114491372157*^9, 3.826114496287735*^9}, {3.8261145842882023`*^9, 
   3.8261146402409773`*^9}, 3.826115153857634*^9, {3.8262048559213657`*^9, 
   3.826204888217414*^9}, {3.826205357233395*^9, 3.82620537350321*^9}, {
   3.826205527453874*^9, 3.826205544896371*^9}, 3.826205816612382*^9, 
   3.826209463682212*^9, {3.826253191892674*^9, 3.826253218836895*^9}, {
   3.826260570132584*^9, 3.82626057119977*^9}, {3.826269411855687*^9, 
   3.8262694193005753`*^9}, {3.826269489627762*^9, 3.826269537608451*^9}, 
   3.8262696346367807`*^9, {3.8262697534687643`*^9, 3.8262697542545652`*^9}, 
   3.8262727132494373`*^9, {3.826273732675786*^9, 3.826273752856138*^9}, {
   3.826274101422929*^9, 3.826274103337572*^9}, {3.8262741475900307`*^9, 
   3.826274168785576*^9}, {3.826286034171837*^9, 3.826286039929357*^9}, {
   3.826366125943212*^9, 3.826366163366455*^9}, 3.826375838274706*^9, {
   3.82637660798433*^9, 3.826376610944675*^9}, {3.826378359222392*^9, 
   3.826378373098852*^9}, {3.826706932522532*^9, 3.826706948297461*^9}, 
   3.826782973708214*^9, 3.8267830172555113`*^9, 3.826786435347891*^9, {
   3.826788537950054*^9, 3.8267885598562937`*^9}, {3.8267970516844463`*^9, 
   3.8267971039510813`*^9}, {3.8267971685701647`*^9, 3.826797170618037*^9}, {
   3.826797237516528*^9, 3.8267972499170094`*^9}, {3.82681087719044*^9, 
   3.826810928684054*^9}, {3.8272208496476603`*^9, 3.827220850872033*^9}, 
   3.82730509850823*^9, 3.82733863827958*^9, {3.82733867563659*^9, 
   3.827338694554545*^9}, 3.827338739134039*^9, {3.827339215110777*^9, 
   3.827339215231278*^9}, {3.8295737957057743`*^9, 3.8295738270489073`*^9}, {
   3.829579275464469*^9, 3.829579277930572*^9}},
 Background->RGBColor[
  0.88, 1, 0.88],ExpressionUUID->"5a275daa-3b38-413f-ac2f-79b35731c85e"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"Det", "[", 
    RowBox[{"gC", "[", 
     RowBox[{"l", ",", "x"}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"l", ",", 
     RowBox[{"-", "1"}], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "20"}], ",", 
   RowBox[{"Evaluate", "@", "font"}], ",", 
   RowBox[{"ScalingFunctions", "\[Rule]", "\"\<Log10\>\""}], ",", " ", 
   RowBox[{"ColorFunction", "\[Rule]", "\"\<SunsetColors\>\""}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<\[Lambda]\>\"", ",", "\"\<\[Chi]\>\"", ",", "\"\<Det(g)\>\""}], 
     "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8263758241279087`*^9, 3.826375859981443*^9}, {
   3.8263762455015383`*^9, 3.826376334810814*^9}, {3.826376376942532*^9, 
   3.826376391205567*^9}, {3.8263766164919767`*^9, 3.8263766184817657`*^9}, {
   3.826788575381411*^9, 3.8267886630763493`*^9}, {3.826788695032156*^9, 
   3.826788695678995*^9}, 3.826788741372075*^9, 3.826797184866165*^9, {
   3.8272208562961683`*^9, 3.827220857317235*^9}, {3.827305104897414*^9, 
   3.827305112903264*^9}, {3.827339455640705*^9, 3.8273394570390778`*^9}, {
   3.827502585422881*^9, 3.827502587271471*^9}, {3.827504383904849*^9, 
   3.827504421076076*^9}, {3.827818652834322*^9, 3.8278186594806547`*^9}, {
   3.827982126474155*^9, 3.8279821286679897`*^9}, {3.829573846242132*^9, 
   3.829573860027*^9}, {3.829617998831748*^9, 3.82961800447001*^9}},
 Background->RGBColor[
  0.88, 1, 0.88],ExpressionUUID->"31d37fab-76f9-47c8-804f-697072f5b100"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compiled geod function and Christoffel symbols", "Title",
 CellChangeTimes->{{3.826806794394163*^9, 3.826806819332657*^9}, {
  3.8274136962750263`*^9, 3.827413708644305*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"4bef5a70-7958-4c35-afe1-fab56cb3096b"],

Cell["\<\
For huge matrices compute only first few energies and check for precission \
{vals,vecs}=Eigensystem[s,10]\
\>", "Text",
 CellChangeTimes->{{3.827161591388788*^9, 3.8271616181472483`*^9}, {
  3.827161650841851*^9, 
  3.827161658176947*^9}},ExpressionUUID->"d13b28e8-dd5a-4650-87bb-\
3cf5470f2a04"],

Cell["Enable more functions to be compilable, for example Inverse", "Text",
 CellChangeTimes->{{3.8271597623166447`*^9, 3.827159796374943*^9}, {
  3.8273900905613422`*^9, 
  3.827390098569948*^9}},ExpressionUUID->"05e33209-33e5-4cfd-a745-\
d95c72f142b4"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Internal`CompileValues", "[", "]"}], ";", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"to", " ", "trigger", " ", "auto"}], "-", "load"}], "*)"}], 
   RowBox[{"ClearAttributes", "[", 
    RowBox[{"Internal`CompileValues", ",", "ReadProtected"}], "]"}], ";", 
   "\n", 
   RowBox[{"syms", "=", 
    RowBox[{
     RowBox[{"DownValues", "[", "Internal`CompileValues", "]"}], "/.", 
     RowBox[{
      RowBox[{"HoldPattern", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Verbatim", "[", "HoldPattern", "]"}], "[", 
         RowBox[{"Internal`CompileValues", "[", "sym_", "]"}], "]"}], 
        "\[RuleDelayed]", "_"}], "]"}], "\[RuleDelayed]", "sym"}]}]}], ";", 
   "\n", 
   RowBox[{"Complement", "[", 
    RowBox[{"syms", ",", 
     RowBox[{"Compile`CompilerFunctions", "[", "]"}]}], "]"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.827159758110302*^9, 3.8271597599805603`*^9}, 
   3.827390085929523*^9, {3.8274810697974043`*^9, 3.82748107108463*^9}, 
   3.82748156519493*^9},
 CellLabel->
  "In[658]:=",ExpressionUUID->"0b8468a8-4a82-4d1e-8c27-6d8c1d65ab2f"],

Cell[CellGroupData[{

Cell["Define area for derivative precision", "Section",
 CellChangeTimes->{{3.82774798914581*^9, 
  3.827748001132259*^9}},ExpressionUUID->"00935c6b-0b28-4a60-b5c9-\
461a2283beea"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"c1", ",", "c2"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"derPiece", "[", 
    RowBox[{
     RowBox[{"\[Lambda]_", "?", "NumericQ"}], ",", 
     RowBox[{"\[Chi]_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{"Piecewise", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"14", ",", 
        RowBox[{
         RowBox[{"\[Lambda]", ">", "1"}], "&&", 
         RowBox[{
          RowBox[{"-", "0.4"}], "<", "\[Chi]", "<", "0.4"}]}]}], "}"}], "}"}],
      ",", 
     RowBox[{"Round", "[", 
      RowBox[{"8", "+", 
       FractionBox["10", 
        RowBox[{"0.8", "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"\[Lambda]", "-", "c1"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Abs", "[", "\[Chi]", "]"}], "-", "c2"}], ")"}], 
          "2"]}]]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"derPieceC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Lambda]", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Chi]", ",", "_Real"}], "}"}]}], "}"}], ",", 
     RowBox[{"Evaluate", "@", 
      RowBox[{"derPiece", "[", 
       RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}]}], ",", 
     RowBox[{"Evaluate", "@", "compileOptions"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"derPiece", "[", 
    RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", ",", 
     RowBox[{"-", "6"}], ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Chi]", ",", 
     RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "30"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", "\"\<SunsetColors\>\""}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.827747256073991*^9, 3.827747367542*^9}, {
   3.82774745922094*^9, 3.8277476638807573`*^9}, {3.827747698820798*^9, 
   3.8277477333868647`*^9}, {3.827747795940586*^9, 3.827747951049479*^9}, {
   3.827748038969091*^9, 3.827748057188167*^9}, {3.827748092913237*^9, 
   3.827748137094233*^9}, {3.827748171754636*^9, 3.8277481781042852`*^9}, {
   3.827748241769198*^9, 3.82774828703264*^9}, {3.8277483539307528`*^9, 
   3.82774836418948*^9}, {3.827748398155857*^9, 3.827748523399811*^9}, {
   3.827748662215816*^9, 3.827748711882021*^9}, {3.827748783409189*^9, 
   3.8277489935080347`*^9}, 3.8277490755063047`*^9, {3.827749225277131*^9, 
   3.8277492324274893`*^9}, {3.8291978986822433`*^9, 3.829197902242523*^9}, {
   3.829197951428372*^9, 3.8291979689784727`*^9}, 3.829214768460683*^9, 
   3.829216282786655*^9, {3.829230503351289*^9, 3.829230558056217*^9}, {
   3.829284258503179*^9, 3.829284288057026*^9}, {3.829284543848421*^9, 
   3.829284546350889*^9}, {3.829572530026479*^9, 3.829572545973795*^9}, {
   3.829573879449506*^9, 
   3.829573881379487*^9}},ExpressionUUID->"2fdbb8b9-0b41-454c-a350-\
e80b2e9cbd02"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Defining compiled functions", "Section",
 CellChangeTimes->{{3.826815124919943*^9, 
  3.826815129651493*^9}},ExpressionUUID->"16dd5be5-0b9a-4b93-b3ed-\
13438bdce288"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"G1", "[", 
   RowBox[{
    RowBox[{"\[Lambda]_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Chi]_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"derTerms", ",", "c", ",", "l", ",", "dg", ",", "gInv"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"derTerms", "=", 
      RowBox[{"derPiece", "[", 
       RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dg", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ND", "[", 
         RowBox[{
          RowBox[{"gC", "[", 
           RowBox[{"l", ",", "\[Chi]"}], "]"}], ",", "l", ",", "\[Lambda]", 
          ",", 
          RowBox[{"Terms", "\[Rule]", "derTerms"}]}], "]"}], ",", 
        RowBox[{"ND", "[", 
         RowBox[{
          RowBox[{"gC", "[", 
           RowBox[{"\[Lambda]", ",", "c"}], "]"}], ",", "c", ",", "\[Chi]", 
          ",", 
          RowBox[{"Terms", "\[Rule]", "derTerms"}]}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"gInv", "=", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"Inverse", "[", 
        RowBox[{"gC", "[", 
         RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"gInv", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "\[Nu]"}], "]"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1", ",", "\[Nu]"}], "]"}], "]"}], "+", 
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "\[Nu]", ",", "1"}], "]"}], "]"}], "-", 
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"\[Nu]", ",", "1", ",", "1"}], "]"}], "]"}]}], ")"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"gInv", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "\[Nu]"}], "]"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1", ",", "\[Nu]"}], "]"}], "]"}], "+", 
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "\[Nu]", ",", "2"}], "]"}], "]"}], "-", 
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"\[Nu]", ",", "1", ",", "2"}], "]"}], "]"}]}], ")"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"gInv", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "\[Nu]"}], "]"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2", ",", "\[Nu]"}], "]"}], "]"}], "+", 
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "\[Nu]", ",", "2"}], "]"}], "]"}], "-", 
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"\[Nu]", ",", "2", ",", "2"}], "]"}], "]"}]}], ")"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "1", ",", "2"}], "}"}]}], "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G2", "[", 
   RowBox[{
    RowBox[{"\[Lambda]_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Chi]_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"derTerms", ",", "c", ",", "l", ",", "dg", ",", "gInv"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"derTerms", "=", 
      RowBox[{"derPiece", "[", 
       RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dg", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ND", "[", 
         RowBox[{
          RowBox[{"gC", "[", 
           RowBox[{"l", ",", "\[Chi]"}], "]"}], ",", "l", ",", "\[Lambda]", 
          ",", 
          RowBox[{"Terms", "\[Rule]", "derTerms"}]}], "]"}], ",", 
        RowBox[{"ND", "[", 
         RowBox[{
          RowBox[{"gC", "[", 
           RowBox[{"\[Lambda]", ",", "c"}], "]"}], ",", "c", ",", "\[Chi]", 
          ",", 
          RowBox[{"Terms", "\[Rule]", "derTerms"}]}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"gInv", "=", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"Inverse", "[", 
        RowBox[{"gC", "[", 
         RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"gInv", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "\[Nu]"}], "]"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1", ",", "\[Nu]"}], "]"}], "]"}], "+", 
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "\[Nu]", ",", "1"}], "]"}], "]"}], "-", 
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"\[Nu]", ",", "1", ",", "1"}], "]"}], "]"}]}], ")"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"gInv", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "\[Nu]"}], "]"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1", ",", "\[Nu]"}], "]"}], "]"}], "+", 
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "\[Nu]", ",", "2"}], "]"}], "]"}], "-", 
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"\[Nu]", ",", "1", ",", "2"}], "]"}], "]"}]}], ")"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"gInv", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "\[Nu]"}], "]"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2", ",", "\[Nu]"}], "]"}], "]"}], "+", 
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "\[Nu]", ",", "2"}], "]"}], "]"}], "-", 
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"\[Nu]", ",", "2", ",", "2"}], "]"}], "]"}]}], ")"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "1", ",", "2"}], "}"}]}], "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.827330387675929*^9, 3.827330496388812*^9}, 
   3.827330532358169*^9, {3.82733057208564*^9, 3.827330617036001*^9}, {
   3.827330657655181*^9, 3.827330736071295*^9}, {3.827330811322097*^9, 
   3.8273308635821247`*^9}, {3.827330930706771*^9, 3.827331066789958*^9}, {
   3.827331134950779*^9, 3.8273312757043657`*^9}, 3.827331951371118*^9, {
   3.8273320316749077`*^9, 3.8273320416419907`*^9}, {3.827334895135139*^9, 
   3.82733491717453*^9}, {3.8273901169389*^9, 3.827390146292315*^9}, {
   3.8274180688657084`*^9, 3.827418102914604*^9}, 3.827418206258108*^9, 
   3.827418243042077*^9, 3.827418536517316*^9, 3.827468335997563*^9, {
   3.827472720868321*^9, 3.8274727388736973`*^9}, {3.827480851511725*^9, 
   3.827480921029867*^9}, {3.82765361206057*^9, 3.8276536261457367`*^9}, {
   3.827746696773283*^9, 3.827746697525725*^9}, {3.827746773091057*^9, 
   3.82774677325358*^9}, 3.827746904347673*^9, {3.827746970061172*^9, 
   3.827746970128512*^9}, {3.82774703305923*^9, 3.827747035205912*^9}, {
   3.8277471001962233`*^9, 3.827747100973106*^9}, 3.827747133758893*^9, {
   3.827747182021112*^9, 3.827747223377768*^9}, {3.827747427213122*^9, 
   3.827747427300713*^9}, 3.827747488876931*^9, {3.827748541088669*^9, 
   3.827748552358199*^9}, {3.827748596292657*^9, 3.827748613538191*^9}, {
   3.8277490649450693`*^9, 3.827749065079445*^9}, {3.827749142335783*^9, 
   3.827749148129592*^9}, {3.828074626684873*^9, 3.828074626868024*^9}, {
   3.829197990333935*^9, 3.8291979918561077`*^9}, {3.829213493130187*^9, 
   3.8292134986489477`*^9}, {3.8292137537947903`*^9, 3.829213756419265*^9}, {
   3.829213908522214*^9, 3.829213915381649*^9}, 3.829214650613697*^9, 
   3.829214699305356*^9, 3.829214821768523*^9, {3.829216106546208*^9, 
   3.829216117688169*^9}, {3.829216183143752*^9, 3.8292161884730597`*^9}, {
   3.829216377961277*^9, 3.829216379820759*^9}, {3.829216902081744*^9, 
   3.829216905417171*^9}, {3.8292169396929703`*^9, 3.829216941686654*^9}, {
   3.829217048306007*^9, 3.829217052876542*^9}, {3.829230248303672*^9, 
   3.8292302555807753`*^9}, {3.829230468181815*^9, 3.829230469542083*^9}, {
   3.829230566578923*^9, 3.829230567769652*^9}},
 CellLabel->
  "In[760]:=",ExpressionUUID->"a22d74c6-0207-4ac7-b9da-e6c4f6049a0d"],

Cell["Check Christoffel symbols. If wrong, increase derTerms.", "Text",
 CellChangeTimes->{{3.827472822237555*^9, 
  3.827472858429557*^9}},ExpressionUUID->"c786ccd5-46ba-4891-b4ed-\
69d4485e9ac3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DensityPlot", "[", 
    RowBox[{
     RowBox[{"ArcTan", "@", 
      RowBox[{
       RowBox[{"G1", "[", 
        RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], "\[LeftDoubleBracket]", 
       "#", "\[RightDoubleBracket]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]", ",", 
       RowBox[{"-", "1"}], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Chi]", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"Evaluate", "@", "densityPlotOptions"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
     RowBox[{"PlotPoints", "\[Rule]", "10"}]}], "]"}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DensityPlot", "[", 
    RowBox[{
     RowBox[{"ArcTan", "@", 
      RowBox[{
       RowBox[{"G2", "[", 
        RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], "\[LeftDoubleBracket]", 
       "#", "\[RightDoubleBracket]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]", ",", 
       RowBox[{"-", "1"}], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Chi]", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"Evaluate", "@", "densityPlotOptions"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
     RowBox[{"PlotPoints", "\[Rule]", "10"}]}], "]"}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", "3"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.8274641692065763`*^9, 3.827464226584159*^9}, {
   3.82746815010643*^9, 3.827468151677326*^9}, {3.827468218744833*^9, 
   3.827468249980638*^9}, {3.827468341559209*^9, 3.827468396219461*^9}, {
   3.827468434656866*^9, 3.8274684838314123`*^9}, {3.827470209341115*^9, 
   3.8274702171488523`*^9}, {3.82747139905254*^9, 3.8274714074081793`*^9}, {
   3.8274718171618423`*^9, 3.827471818625355*^9}, {3.827472603801539*^9, 
   3.8274726056983023`*^9}, {3.827472667961306*^9, 3.82747270046986*^9}, {
   3.827472762400756*^9, 3.82747277526095*^9}, {3.8274728139385147`*^9, 
   3.827472817591054*^9}, {3.827472866045895*^9, 3.8274728793129272`*^9}, {
   3.82748042637534*^9, 3.827480429772279*^9}, {3.827480758520101*^9, 
   3.827480789136479*^9}, {3.8274808393340883`*^9, 3.827480840464386*^9}, {
   3.827480873292595*^9, 3.8274809013802023`*^9}, 3.827481389721727*^9, {
   3.827481585571563*^9, 3.827481590187933*^9}, 3.827481672145317*^9, {
   3.827644124870634*^9, 3.8276441273961287`*^9}, {3.827644255025114*^9, 
   3.827644257022574*^9}, {3.829216632709567*^9, 3.829216633742896*^9}, {
   3.829573894717784*^9, 3.829573908761949*^9}},
 Background->RGBColor[
  0.88, 1, 0.88],ExpressionUUID->"85c3cf1a-0a96-4a61-aeda-5acee53e637a"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{774, 1419},
WindowMargins->{{777, Automatic}, {Automatic, 1}},
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 169, 3, 68, "Section",ExpressionUUID->"3f7e1bf1-67b3-4e98-b2b0-2eac7608b588"],
Cell[752, 27, 157, 3, 31, "Input",ExpressionUUID->"742f1702-d7ea-459a-a834-c38fe42c2084"],
Cell[912, 32, 3089, 71, 331, "Input",ExpressionUUID->"ac2ab778-8cd4-4fed-9175-bb82b0360369"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4038, 108, 265, 5, 76, "Section",ExpressionUUID->"67109e61-46c7-498d-a511-837ee58c2df1"],
Cell[4306, 115, 485, 11, 47, "Input",ExpressionUUID->"42ba692e-ef03-4759-9c97-7c9f7c114aef"],
Cell[4794, 128, 889, 25, 57, "Input",ExpressionUUID->"238d529a-9c63-4108-9241-a6f9de282367"],
Cell[5686, 155, 5279, 145, 355, "Input",ExpressionUUID->"25d91350-2c5c-4f3f-b989-79cf79f4d75e"],
Cell[10968, 302, 5583, 111, 209, "Input",ExpressionUUID->"523b20e6-2551-4989-a8b3-b75182c1be1c"],
Cell[CellGroupData[{
Cell[16576, 417, 1206, 24, 71, "Input",ExpressionUUID->"588a8161-55a8-4c8d-9c71-379a153199a6"],
Cell[17785, 443, 2370, 34, 25, "Print",ExpressionUUID->"6dafcf27-97f5-4ab8-85ec-f0f5246be28c"]
}, Open  ]],
Cell[20170, 480, 10464, 254, 439, "Input",ExpressionUUID->"34845260-54b5-4b77-b773-4a52c8bb1883"],
Cell[CellGroupData[{
Cell[30659, 738, 256, 6, 31, "Input",ExpressionUUID->"c7e6b888-a626-4dcd-9e2f-6b9dbe27ce5a"],
Cell[30918, 746, 535, 15, 35, "Output",ExpressionUUID->"82ac6c9a-ed47-4964-8338-b457a40a7bc3"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[31502, 767, 155, 3, 68, "Section",ExpressionUUID->"fd819d28-3795-4351-adc3-62bd07895de8"],
Cell[CellGroupData[{
Cell[31682, 774, 485, 14, 55, "Input",ExpressionUUID->"722dc7c3-b2b4-40ec-8d73-99f308a0d85f"],
Cell[32170, 790, 354, 9, 22, "Message",ExpressionUUID->"7797f38c-b902-4f86-835b-2d2515532220"],
Cell[32527, 801, 160, 3, 35, "Output",ExpressionUUID->"88152e11-1732-4d06-8515-557340d7cda5"]
}, Open  ]],
Cell[32702, 807, 723, 20, 55, "Input",ExpressionUUID->"38e6c631-f2b0-411c-9d90-11f88873d6dc"],
Cell[33428, 829, 1367, 29, 78, "Input",ExpressionUUID->"d793b69e-b17f-4490-8cc9-17051b7a13d5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34832, 863, 209, 4, 68, "Section",ExpressionUUID->"b7f68653-2eb3-498b-9d2b-25b66baaab8e"],
Cell[35044, 869, 2441, 58, 186, "Input",ExpressionUUID->"24867617-a746-45f7-aed9-3ab029b2eedc"],
Cell[CellGroupData[{
Cell[37510, 931, 272, 4, 57, "Subsubsection",ExpressionUUID->"fbb9c723-aca4-4bfc-a861-986f6c2cd988"],
Cell[37785, 937, 2635, 44, 71, "Input",ExpressionUUID->"5a275daa-3b38-413f-ac2f-79b35731c85e"],
Cell[40423, 983, 1623, 32, 94, "Input",ExpressionUUID->"31d37fab-76f9-47c8-804f-697072f5b100"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[42095, 1021, 268, 4, 178, "Title",ExpressionUUID->"4bef5a70-7958-4c35-afe1-fab56cb3096b"],
Cell[42366, 1027, 307, 7, 60, "Text",ExpressionUUID->"d13b28e8-dd5a-4650-87bb-3cf5470f2a04"],
Cell[42676, 1036, 254, 4, 36, "Text",ExpressionUUID->"05e33209-33e5-4cfd-a745-d95c72f142b4"],
Cell[42933, 1042, 1125, 29, 147, "Input",ExpressionUUID->"0b8468a8-4a82-4d1e-8c27-6d8c1d65ab2f"],
Cell[CellGroupData[{
Cell[44083, 1075, 180, 3, 68, "Section",ExpressionUUID->"00935c6b-0b28-4a60-b5c9-461a2283beea"],
Cell[44266, 1080, 3260, 81, 224, "Input",ExpressionUUID->"2fdbb8b9-0b41-454c-a350-e80b2e9cbd02"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47563, 1166, 172, 3, 68, "Section",ExpressionUUID->"16dd5be5-0b9a-4b93-b3ed-13438bdce288"],
Cell[47738, 1171, 9427, 234, 489, "Input",ExpressionUUID->"a22d74c6-0207-4ac7-b9da-e6c4f6049a0d"],
Cell[57168, 1407, 197, 3, 36, "Text",ExpressionUUID->"c786ccd5-46ba-4891-b4ed-69d4485e9ac3"],
Cell[57368, 1412, 2680, 56, 163, "Input",ExpressionUUID->"85c3cf1a-0a96-4a61-aeda-5acee53e637a"]
}, Open  ]]
}, Open  ]]
}
]
*)


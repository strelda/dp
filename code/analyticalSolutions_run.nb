(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[     66889,       1697]
NotebookOptionsPosition[     63404,       1629]
NotebookOutlinePosition[     63782,       1646]
CellTagsIndexPosition[     63739,       1643]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Inicialize some functions", "Chapter",
 CellChangeTimes->{{3.826384236370326*^9, 3.82638424998965*^9}, {
  3.827984924738978*^9, 
  3.8279849262557697`*^9}},ExpressionUUID->"d5df468e-12ce-4338-9041-\
7afd652b4ae3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"<<", "CompiledFunctionTools`"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "MaTeX`"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<NumericalCalculus`\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileOptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
     RowBox[{"RuntimeOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<EvaluateSymbolically\>\"", "\[Rule]", "False"}], ",", 
        RowBox[{"\"\<CatchMachineUnderflow\>\"", "\[Rule]", "False"}], ",", 
        RowBox[{"\"\<CatchMachineOverflow\>\"", "\[Rule]", "False"}]}], 
       "}"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"font", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"FontSize", "\[Rule]", "12"}], "]"}]}], ",", 
     RowBox[{"AxesStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"FontSize", "\[Rule]", "12"}], "]"}]}], ",", 
     RowBox[{"TicksStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"FontSize", "\[Rule]", "12"}], "]"}]}], ",", 
     RowBox[{"LabelStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Latin Modern Roman\>\""}], ",", 
        
        RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], "}"}]}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", "texStyle"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"densityPlotOptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"MaTeX", "/@", 
       RowBox[{"{", 
        RowBox[{"\"\<\\\\lambda\>\"", ",", "\"\<\\\\chi\>\""}], "}"}]}]}], 
     ",", 
     RowBox[{"Evaluate", "@", "font"}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", "\"\<SunsetColors\>\""}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.826001345692895*^9, 3.826001348605947*^9}, {
   3.8260139995791492`*^9, 3.826013999879569*^9}, {3.82601594953941*^9, 
   3.826015949819188*^9}, {3.826018339604105*^9, 3.826018339889323*^9}, {
   3.8261181110860233`*^9, 3.826118114942244*^9}, {3.826814273659827*^9, 
   3.82681428638478*^9}, {3.826857980934136*^9, 3.826857990593255*^9}, 
   3.8268690897281027`*^9, 3.8281054483656178`*^9},
 CellLabel->"In[94]:=",ExpressionUUID->"b534aa99-0e08-4714-b452-59481de72866"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Defining the Hamiltonian", "Chapter"]], "Subtitle",
 CellChangeTimes->{{3.826016188132229*^9, 3.8260162092821083`*^9}, {
   3.826119184120637*^9, 3.826119191218803*^9}, {3.826857696882537*^9, 
   3.8268576991879473`*^9}, 3.8268589477226067`*^9, {3.827145969984063*^9, 
   3.827145973705883*^9}},ExpressionUUID->"97a69f8f-14be-40f6-90d1-\
74a26f8e2eea"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Lambda]", "\[Element]", "Reals"}], ",", 
     RowBox[{"\[Chi]", "\[Element]", "Reals"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"as", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Lambda]", "\[Element]", "Reals"}], ",", 
     RowBox[{"\[Chi]", "\[Element]", "Reals"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.826016881006897*^9, 3.8260168911810923`*^9}, {
   3.8261141474854403`*^9, 3.82611416004382*^9}, 3.8267806944634323`*^9, {
   3.826874147575489*^9, 3.826874155752179*^9}},
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[100]:=",ExpressionUUID->"38ed4e28-b1a5-4013-bf2e-686ec8fc4134"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Delta]", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"KroneckerDelta", "[", 
    RowBox[{"a", ",", "b"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Je", "[", 
    RowBox[{"sn_", ",", "j_", ",", "m_"}], "]"}], ":=", 
   SqrtBox[
    RowBox[{
     RowBox[{"j", 
      RowBox[{"(", 
       RowBox[{"j", "+", "1"}], ")"}]}], "-", 
     RowBox[{"m", 
      RowBox[{"(", 
       RowBox[{"m", "+", 
        RowBox[{"sn", " ", "1"}]}], ")"}]}]}]]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8259986497553263`*^9, 3.825998672604487*^9}, {
   3.8259992399132967`*^9, 3.825999321050805*^9}, 3.8259993623614607`*^9, {
   3.825999464925118*^9, 3.8259994658587723`*^9}, {3.826785390512155*^9, 
   3.8267854380515547`*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"b0e155c1-af50-47d1-aab4-f3c3ae1f6939"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"V1", "[", 
   RowBox[{"jp_", ",", "mp_", ",", "j_", ",", "m_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", "4"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Je", "[", 
       RowBox[{"1", ",", "j", ",", 
        RowBox[{"m", "+", "1"}]}], "]"}], 
      RowBox[{"Je", "[", 
       RowBox[{"1", ",", "j", ",", "m"}], "]"}], 
      RowBox[{"\[Delta]", "[", 
       RowBox[{"mp", ",", 
        RowBox[{"m", "+", "2"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"Je", "[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "j", ",", 
        RowBox[{"m", "-", "1"}]}], "]"}], 
      RowBox[{"Je", "[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "j", ",", "m"}], "]"}], 
      RowBox[{"\[Delta]", "[", 
       RowBox[{"mp", ",", 
        RowBox[{"m", "-", "2"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"\[Delta]", "[", 
       RowBox[{"mp", ",", "m"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Je", "[", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "j", ",", "m"}], "]"}], 
         RowBox[{"Je", "[", 
          RowBox[{"1", ",", "j", ",", 
           RowBox[{"m", "-", "1"}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Je", "[", 
          RowBox[{"1", ",", "j", ",", "m"}], "]"}], 
         RowBox[{"Je", "[", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "j", ",", 
           RowBox[{"m", "+", "1"}]}], "]"}]}]}], " ", ")"}]}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V2", "[", 
   RowBox[{"jp_", ",", "mp_", ",", "j_", ",", "m_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"m", "+", "j"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Je", "[", 
        RowBox[{"1", ",", "j", ",", "m"}], "]"}], 
       RowBox[{"\[Delta]", "[", 
        RowBox[{"mp", ",", 
         RowBox[{"m", "+", "1"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"Je", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "j", ",", "m"}], "]"}], 
       RowBox[{"\[Delta]", "[", 
        RowBox[{"mp", ",", 
         RowBox[{"m", "-", "1"}]}], "]"}]}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"m", "+", "1", "+", "j"}], ")"}], 
    RowBox[{"Je", "[", 
     RowBox[{"1", ",", "j", ",", "m"}], "]"}], 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"mp", ",", 
      RowBox[{"m", "+", "1"}]}], "]"}]}], "+", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"m", "-", "1", "+", "j"}], ")"}], 
    RowBox[{"Je", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "j", ",", "m"}], "]"}], 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"mp", ",", 
      RowBox[{"m", "-", "1"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V3", "[", 
   RowBox[{"jp_", ",", "mp_", ",", "j_", ",", "m_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"\[Delta]", "[", 
    RowBox[{"mp", ",", "m"}], "]"}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"j", "+", "m"}], ")"}], "2"]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hd", "[", 
   RowBox[{"jp_", ",", "mp_", ",", "j_", ",", "m_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"m", " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"jp", ",", "j"}], "]"}], 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"mp", ",", "m"}], "]"}]}], "-", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Delta]", "[", 
      RowBox[{"jp", ",", "j"}], "]"}], 
     RowBox[{"2", "j"}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Lambda]", " ", 
       RowBox[{"V1", "[", 
        RowBox[{"jp", ",", "mp", ",", "j", ",", "m"}], "]"}]}], "+", 
      RowBox[{"\[Chi]", " ", 
       RowBox[{"V2", "[", 
        RowBox[{"jp", ",", "mp", ",", "j", ",", "m"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["\[Chi]", "2"], 
       RowBox[{"V3", "[", 
        RowBox[{"jp", ",", "mp", ",", "j", ",", "m"}], "]"}]}]}], 
     ")"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.825998224534062*^9, 3.825998405469041*^9}, {
   3.825998550619458*^9, 3.8259986375936413`*^9}, {3.825998676545611*^9, 
   3.825998751336893*^9}, {3.825998786526939*^9, 3.825998954315954*^9}, {
   3.825999023109066*^9, 3.825999023359281*^9}, 3.825999133747304*^9, 
   3.825999166186602*^9, {3.8259992103558817`*^9, 3.8259992262577887`*^9}, 
   3.825999410725338*^9, {3.825999481715238*^9, 3.825999492911231*^9}, {
   3.826000566993601*^9, 3.8260005705463123`*^9}, {3.826002809665291*^9, 
   3.826002810780651*^9}, {3.826002905483427*^9, 3.8260029414279823`*^9}, {
   3.82600913393906*^9, 3.8260091424566402`*^9}, 3.826009176683318*^9, 
   3.826009993816455*^9, {3.826269356423053*^9, 3.826269359486989*^9}, {
   3.826781103000942*^9, 3.826781104147229*^9}, 3.826781134973575*^9, {
   3.826781309839685*^9, 3.8267813528773623`*^9}, {3.826781899244912*^9, 
   3.826781997115054*^9}, {3.826782093318408*^9, 3.8267821240732203`*^9}, {
   3.8267821888273582`*^9, 3.8267822089563103`*^9}, {3.826782383581203*^9, 
   3.826782423615696*^9}, {3.826785167962628*^9, 3.826785204023613*^9}, {
   3.826786182869647*^9, 3.826786191668026*^9}, {3.826786242206399*^9, 
   3.82678624274267*^9}},
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[104]:=",ExpressionUUID->"6fea32da-919a-4123-816b-c6113da0e0eb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["N = 3", "Title",
 CellChangeTimes->{{3.8277645489029408`*^9, 
  3.827764558516471*^9}},ExpressionUUID->"01f2ec63-811d-4c78-8e8c-\
7719171f8481"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nn", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"jj", "=", 
    RowBox[{"nn", "/", "2"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dim", "=", 
   RowBox[{"nn", "+", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{"mp_", ",", "m_"}], "]"}], ":=", 
  RowBox[{"Hd", "[", 
   RowBox[{"jj", ",", "mp", ",", "jj", ",", "m"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HH", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"mp", ",", "m"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"mp", ",", 
       RowBox[{"-", "jj"}], ",", "jj"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", 
       RowBox[{"-", "jj"}], ",", "jj"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "[", 
   RowBox[{"\[Lambda]_", ",", "\[Chi]_"}], "]"}], "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"mp", ",", "m"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"mp", ",", 
      RowBox[{"-", "jj"}], ",", "jj"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"m", ",", 
      RowBox[{"-", "jj"}], ",", "jj"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Lambda]", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Chi]", ",", "_Real"}], "}"}]}], "}"}], ",", 
     RowBox[{"Evaluate", "@", "HH"}], ",", 
     RowBox[{"Evaluate", "@", "compileOptions"}]}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.825999808451119*^9, 3.8259999610816708`*^9}, {
   3.826000016975996*^9, 3.82600021542994*^9}, {3.826000301558736*^9, 
   3.826000356752215*^9}, {3.826000476089918*^9, 3.826000489009012*^9}, 
   3.826000606480093*^9, {3.826001248142696*^9, 3.826001253228297*^9}, {
   3.826002813122592*^9, 3.826002816305376*^9}, {3.826007215470689*^9, 
   3.8260072491426573`*^9}, {3.826007733027317*^9, 3.826007839159418*^9}, {
   3.82600804031494*^9, 3.826008040724723*^9}, 3.826008724291765*^9, {
   3.8260088027080507`*^9, 3.8260088143722773`*^9}, {3.826009110457657*^9, 
   3.8260091902578373`*^9}, {3.826014975056283*^9, 3.826014981764826*^9}, 
   3.826015225251341*^9, {3.8260182055850687`*^9, 3.826018227392696*^9}, 
   3.82625340451791*^9, {3.82625429365051*^9, 3.826254296472508*^9}, {
   3.826269267381939*^9, 3.826269267586198*^9}, 3.8262742705075274`*^9, 
   3.826274836707177*^9, 3.8262845970554237`*^9, {3.826286010013372*^9, 
   3.826286010555134*^9}, 3.8262915480877323`*^9, {3.826376529555462*^9, 
   3.826376531981254*^9}, {3.8267049725035563`*^9, 3.826704975305242*^9}, 
   3.826706911880579*^9, {3.826770600646803*^9, 3.826770603175046*^9}, 
   3.8267715508219557`*^9, {3.8267801996793003`*^9, 3.826780203628392*^9}, {
   3.8267803392925797`*^9, 3.82678034218423*^9}, {3.82678038867212*^9, 
   3.826780416786552*^9}, 3.8267804785045013`*^9, {3.826781371568959*^9, 
   3.8267813795691223`*^9}, 3.8267814314774523`*^9, {3.82678240284226*^9, 
   3.826782453442974*^9}, {3.826782715112446*^9, 3.82678275928166*^9}, {
   3.8267845876157703`*^9, 3.826784587919712*^9}, {3.826785971199977*^9, 
   3.826785975622019*^9}, 3.826786319984289*^9, {3.826786356672811*^9, 
   3.826786357594757*^9}, 3.826787515011897*^9, {3.8267876081173887`*^9, 
   3.826787622031723*^9}, 3.826787732501113*^9, {3.826795431856983*^9, 
   3.8267954341664047`*^9}, {3.826813520299404*^9, 3.826813626309408*^9}, {
   3.826813723194812*^9, 3.826813844003036*^9}, {3.826813880992138*^9, 
   3.82681393839599*^9}, {3.8268139853680696`*^9, 3.826814025311205*^9}, {
   3.826814076634532*^9, 3.82681407936908*^9}, {3.8268141795755796`*^9, 
   3.826814197534822*^9}, {3.826814229660845*^9, 3.826814256217836*^9}, {
   3.82681479522786*^9, 3.826814797802899*^9}, {3.826814971697074*^9, 
   3.826815011612728*^9}, 3.826815144613723*^9, 3.8268577621254377`*^9, {
   3.826860045096121*^9, 3.826860057209312*^9}, {3.82686010193777*^9, 
   3.826860103492037*^9}, {3.826860355140483*^9, 3.826860375308462*^9}, 
   3.826861367893744*^9, 3.826861638183674*^9, {3.8268858337534513`*^9, 
   3.8268858351458817`*^9}, 3.826887395641069*^9, {3.826888414447085*^9, 
   3.826888423400957*^9}, 3.827146059292638*^9, {3.827220337949026*^9, 
   3.8272203395117702`*^9}, 3.827410876548112*^9, 3.8274109675280046`*^9, 
   3.827411321984845*^9, 3.827411361837557*^9, 3.827764622036764*^9, 
   3.8279338929101562`*^9},
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[108]:=",ExpressionUUID->"606f51cf-fb0a-4350-8000-0b2248996519"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["3", "2"]}], "-", 
      FractionBox["\[Lambda]", "4"]}], ",", 
     RowBox[{"-", 
      FractionBox["\[Chi]", 
       RowBox[{"2", " ", 
        SqrtBox["3"]}]]}], ",", 
     RowBox[{"-", 
      FractionBox["\[Lambda]", 
       RowBox[{"2", " ", 
        SqrtBox["3"]}]]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["\[Chi]", 
       RowBox[{"2", " ", 
        SqrtBox["3"]}]]}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], "+", 
      RowBox[{
       FractionBox["1", "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"7", " ", "\[Lambda]"}], "4"]}], "-", 
         SuperscriptBox["\[Chi]", "2"]}], ")"}]}]}], ",", 
     RowBox[{"-", "\[Chi]"}], ",", 
     RowBox[{"-", 
      FractionBox["\[Lambda]", 
       RowBox[{"2", " ", 
        SqrtBox["3"]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["\[Lambda]", 
       RowBox[{"2", " ", 
        SqrtBox["3"]}]]}], ",", 
     RowBox[{"-", "\[Chi]"}], ",", 
     RowBox[{
      FractionBox["1", "2"], "+", 
      RowBox[{
       FractionBox["1", "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"7", " ", "\[Lambda]"}], "4"]}], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["\[Chi]", "2"]}]}], ")"}]}]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"5", " ", "\[Chi]"}], 
       RowBox[{"2", " ", 
        SqrtBox["3"]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox["\[Lambda]", 
       RowBox[{"2", " ", 
        SqrtBox["3"]}]]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"5", " ", "\[Chi]"}], 
       RowBox[{"2", " ", 
        SqrtBox["3"]}]]}], ",", 
     RowBox[{
      FractionBox["3", "2"], "+", 
      RowBox[{
       FractionBox["1", "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"3", " ", "\[Lambda]"}], "4"]}], "-", 
         RowBox[{"9", " ", 
          SuperscriptBox["\[Chi]", "2"]}]}], ")"}]}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.826813624789562*^9, 3.8268136267073917`*^9}, {
   3.826813724219681*^9, 3.826813827754809*^9}, {3.82681388125397*^9, 
   3.826813938930529*^9}, {3.8268139858083*^9, 3.826814025813519*^9}, {
   3.8268140798195763`*^9, 3.826814089337006*^9}, {3.826814181008396*^9, 
   3.826814297109021*^9}, 3.8268145976559067`*^9, 3.826814798465271*^9, 
   3.826814884420197*^9, {3.826815012929132*^9, 3.826815018830697*^9}, 
   3.826815147886836*^9, 3.826816750985937*^9, 3.8268169944759703`*^9, 
   3.826819238834627*^9, 3.8268233100448103`*^9, 3.8268547233040657`*^9, 
   3.826858872875463*^9, 3.8268598144788322`*^9, 3.826860104666279*^9, 
   3.826860279508655*^9, {3.826860358664896*^9, 3.826860380180338*^9}, 
   3.826860587629097*^9, 3.826861190751649*^9, 3.826861375063292*^9, 
   3.826861473953389*^9, 3.826861641450594*^9, 3.8268684836539907`*^9, 
   3.826868849431748*^9, 3.826869100085204*^9, 3.82687519132957*^9, 
   3.826876315683876*^9, 3.8268858550206738`*^9, 3.826887408145977*^9, 
   3.826888021548052*^9, {3.8268884325379047`*^9, 3.826888440176095*^9}, 
   3.826889187193364*^9, 3.826889909793479*^9, 3.8269095717270412`*^9, 
   3.827146060927216*^9, 3.8271461477180367`*^9, 3.827158269309884*^9, {
   3.8271583396429987`*^9, 3.827158358632827*^9}, 3.827205116955971*^9, 
   3.827218170008628*^9, 3.827220339994093*^9, 3.8272205903491697`*^9, 
   3.827221300529386*^9, 3.827229924118003*^9, 3.827240322389007*^9, 
   3.827392865327746*^9, 3.8274016242596817`*^9, 3.827409292304455*^9, 
   3.827410877704545*^9, 3.827410968523431*^9, 3.827411363622617*^9, 
   3.82776423156391*^9, 3.8277646227465553`*^9, 3.827765675894589*^9, 
   3.827926366521674*^9, 3.827926527938224*^9, 3.827927859776927*^9, 
   3.827933558140296*^9, 3.8279337899095583`*^9, 3.827933821926626*^9, 
   3.827933894041971*^9, 3.827934006529604*^9, 3.827934435560937*^9, 
   3.827934511806786*^9, 3.827934543693624*^9, 3.827934866056114*^9, 
   3.827983555472793*^9, 3.827984989518846*^9, 3.8280247939628763`*^9, 
   3.8281054631708603`*^9, 3.828263107383548*^9, 3.828446631010089*^9, 
   3.828693899701581*^9, 3.828781653657699*^9},
 CellLabel->
  "Out[113]=",ExpressionUUID->"9733aff7-4dd9-418d-afd6-f86eb698096b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"ConjugateTranspose", "@", 
     RowBox[{"H", "[", 
      RowBox[{"2", ",", "7"}], "]"}]}], "\[Equal]", 
    RowBox[{"H", "[", 
     RowBox[{"2", ",", "7"}], "]"}]}], ",", 
   RowBox[{"Print", "[", "\"\<Probably is Hermitean\>\"", "]"}], ",", 
   RowBox[{"Print", "[", "\"\<THIS IS NOT Hermitean\>\"", "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H", "[", 
    RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], "//", "MatrixForm"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.8260102123327627`*^9, 3.826010392321637*^9}, {
   3.826015004116428*^9, 3.826015023614376*^9}, {3.826376535621965*^9, 
   3.826376537921674*^9}, {3.826388820047048*^9, 3.8263888253027554`*^9}, {
   3.826780377255237*^9, 3.8267803796517353`*^9}, {3.826782229295322*^9, 
   3.826782260108252*^9}, {3.82678229349629*^9, 3.826782399128501*^9}, {
   3.826813645916296*^9, 3.826813708552185*^9}, {3.826813946381761*^9, 
   3.8268139530260887`*^9}, 3.826814099101132*^9, {3.826814211785392*^9, 
   3.826814221571555*^9}, 3.826814894589082*^9, {3.826815025527907*^9, 
   3.826815030035215*^9}, {3.826860065285283*^9, 3.826860066804677*^9}, 
   3.8268884276145487`*^9},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[115]:=",ExpressionUUID->"9f1cac35-e1c3-477a-b623-b5e83e436118"],

Cell[BoxData["\<\"Probably is Hermitean\"\>"], "Print",
 CellChangeTimes->{{3.826814884563307*^9, 3.826814895102754*^9}, {
   3.826815018863085*^9, 3.826815030404848*^9}, 3.826816751125478*^9, 
   3.8268169946994047`*^9, 3.8268192389789753`*^9, 3.826823310187644*^9, 
   3.8268547234524393`*^9, 3.826858873009488*^9, 3.826859814616857*^9, 
   3.826860105648999*^9, 3.826860279647715*^9, {3.826860358823938*^9, 
   3.8268603803303623`*^9}, 3.8268605877559032`*^9, 3.8268611908891706`*^9, 
   3.8268613752155943`*^9, 3.826861474080216*^9, 3.826861641598078*^9, 
   3.826868484106658*^9, 3.8268688495527554`*^9, 3.826869100200704*^9, 
   3.826875191637189*^9, 3.8268763158632803`*^9, 3.826885855293084*^9, 
   3.82688740833202*^9, 3.82688802173522*^9, {3.82688843271059*^9, 
   3.8268884403336163`*^9}, 3.826889187371155*^9, 3.826889909958112*^9, 
   3.826909572010569*^9, 3.82714606785032*^9, 3.8271461479115868`*^9, 
   3.827205120935361*^9, 3.827218171934081*^9, 3.8272203427939377`*^9, 
   3.8273928682569237`*^9, 3.827764386607568*^9, 3.827764625170403*^9, 
   3.827765676038142*^9, 3.827926368067678*^9, 3.827926530597506*^9, 
   3.8279278611818247`*^9, 3.827933560181171*^9, 3.827933824964451*^9, 
   3.827984991327779*^9, 3.828024797894746*^9, 3.828263110294861*^9, 
   3.828781653902375*^9},
 CellLabel->
  "During evaluation of \
In[115]:=",ExpressionUUID->"1ed8421a-d97b-466a-adee-908ee891ac46"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "6"}], "-", "\[Lambda]"}], ")"}]}], 
      RowBox[{"-", 
       FractionBox["\[Chi]", 
        RowBox[{"2", " ", 
         SqrtBox["3"]}]]}], 
      RowBox[{"-", 
       FractionBox["\[Lambda]", 
        RowBox[{"2", " ", 
         SqrtBox["3"]}]]}], "0"},
     {
      RowBox[{"-", 
       FractionBox["\[Chi]", 
        RowBox[{"2", " ", 
         SqrtBox["3"]}]]}], 
      RowBox[{
       FractionBox["1", "12"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "6"}], "-", 
         RowBox[{"7", " ", "\[Lambda]"}], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["\[Chi]", "2"]}]}], ")"}]}], 
      RowBox[{"-", "\[Chi]"}], 
      RowBox[{"-", 
       FractionBox["\[Lambda]", 
        RowBox[{"2", " ", 
         SqrtBox["3"]}]]}]},
     {
      RowBox[{"-", 
       FractionBox["\[Lambda]", 
        RowBox[{"2", " ", 
         SqrtBox["3"]}]]}], 
      RowBox[{"-", "\[Chi]"}], 
      RowBox[{
       FractionBox["1", "12"], " ", 
       RowBox[{"(", 
        RowBox[{"6", "-", 
         RowBox[{"7", " ", "\[Lambda]"}], "-", 
         RowBox[{"16", " ", 
          SuperscriptBox["\[Chi]", "2"]}]}], ")"}]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"5", " ", "\[Chi]"}], 
        RowBox[{"2", " ", 
         SqrtBox["3"]}]]}]},
     {"0", 
      RowBox[{"-", 
       FractionBox["\[Lambda]", 
        RowBox[{"2", " ", 
         SqrtBox["3"]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"5", " ", "\[Chi]"}], 
        RowBox[{"2", " ", 
         SqrtBox["3"]}]]}], 
      RowBox[{
       FractionBox["3", "2"], "-", 
       FractionBox["\[Lambda]", "4"], "-", 
       RowBox[{"3", " ", 
        SuperscriptBox["\[Chi]", "2"]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.826009194206859*^9, 3.826009997862571*^9, {3.826010273885894*^9, 
   3.826010299410287*^9}, {3.8260103803627243`*^9, 3.8260103958879347`*^9}, 
   3.826011185260483*^9, 3.8260148401287127`*^9, 3.8260148937866287`*^9, {
   3.826014996837311*^9, 3.8260150241460333`*^9}, 3.826015955198731*^9, 
   3.826016917297165*^9, {3.8260182095354013`*^9, 3.826018229762062*^9}, 
   3.82601835294497*^9, 3.826114176647278*^9, {3.826115930810656*^9, 
   3.8261159584441843`*^9}, 3.8261166338146687`*^9, 3.8261182307548018`*^9, 
   3.826203469784913*^9, 3.826204208789011*^9, 3.826204918323051*^9, 
   3.826205281801589*^9, 3.826205829773746*^9, 3.826214564975966*^9, 
   3.826214748998288*^9, 3.826216034527516*^9, 3.826250437564077*^9, 
   3.826253207903466*^9, {3.826253407432369*^9, 3.826253433574813*^9}, 
   3.826254313640926*^9, 3.826254803643984*^9, 3.826260463189756*^9, 
   3.826265105501176*^9, 3.826265800891357*^9, 3.826267175164269*^9, 
   3.826269004270761*^9, 3.82626928589375*^9, 3.8262693985942497`*^9, 
   3.826269670112789*^9, 3.826270817495947*^9, 3.826272724399412*^9, 
   3.8262742822616577`*^9, 3.8262748449166813`*^9, 3.8262834541904497`*^9, 
   3.826283927755137*^9, 3.826283970314834*^9, 3.826284607251483*^9, 
   3.82628601886497*^9, 3.8262871527974863`*^9, 3.82629162623553*^9, 
   3.82629452623897*^9, 3.826294852037183*^9, 3.826366014178014*^9, 
   3.826375600860482*^9, 3.826376550883885*^9, 3.8263779410454073`*^9, 
   3.8263808714614687`*^9, 3.826382405489401*^9, 3.826383582762342*^9, 
   3.8263842645922813`*^9, 3.826385009184681*^9, 3.826385237246109*^9, 
   3.826385416756365*^9, 3.826385633289336*^9, 3.826387772540988*^9, {
   3.826388821967005*^9, 3.8263888258193483`*^9}, 3.826621767662538*^9, 
   3.8266218295875597`*^9, 3.826704024210505*^9, 3.826704637349111*^9, 
   3.826704967883128*^9, 3.8267069169614897`*^9, 3.8267093235956087`*^9, 
   3.826711142315679*^9, 3.8267112320764027`*^9, 3.826715727785378*^9, 
   3.826716479552163*^9, 3.826719287741333*^9, 3.826731770642352*^9, 
   3.8267706114183683`*^9, 3.826771557586691*^9, 3.8267803472483253`*^9, {
   3.826780380019124*^9, 3.826780431798492*^9}, 3.826780484234558*^9, {
   3.826781366291728*^9, 3.826781382281804*^9}, 3.8267814337042437`*^9, {
   3.826782013193694*^9, 3.826782038356051*^9}, 3.826782129448627*^9, {
   3.826782212134651*^9, 3.826782257546208*^9}, {3.826782300760665*^9, 
   3.82678230656743*^9}, {3.8267823685653677`*^9, 3.826782457674816*^9}, 
   3.8267827536253967`*^9, 3.8267833979892*^9, 3.826784594316681*^9, 
   3.826784920129445*^9, 3.826785207863215*^9, 3.826785421586795*^9, 
   3.826785978323586*^9, 3.826786195669484*^9, 3.826786246798312*^9, 
   3.826786322873563*^9, 3.826786360394306*^9, 3.826787519438191*^9, 
   3.8267906751927147`*^9, 3.826795439645608*^9, 3.826799160460841*^9, 
   3.8268076259073963`*^9, 3.826811265567546*^9, {3.826813569687454*^9, 
   3.826813590468069*^9}, {3.8268136222393303`*^9, 3.826813709262944*^9}, {
   3.826813945134569*^9, 3.826813953492957*^9}, {3.8268140021729527`*^9, 
   3.826814028633779*^9}, {3.826814082778743*^9, 3.826814100549755*^9}, {
   3.8268141951960897`*^9, 3.8268142363107862`*^9}, 3.826814597968072*^9, 
   3.826814801014298*^9, {3.826814884567576*^9, 3.8268148951376543`*^9}, {
   3.826815018887712*^9, 3.826815030410467*^9}, 3.826816751128932*^9, 
   3.8268169947134247`*^9, 3.8268192390079193`*^9, 3.826823310191352*^9, 
   3.826854723479991*^9, 3.8268588730124397`*^9, 3.826859814620639*^9, 
   3.8268601056516657`*^9, 3.8268602796512136`*^9, {3.826860358827408*^9, 
   3.826860380333741*^9}, 3.826860587759136*^9, 3.82686119089248*^9, 
   3.82686137523452*^9, 3.82686147410789*^9, 3.8268616416013412`*^9, 
   3.826868484108699*^9, 3.826868849555172*^9, 3.826869100202743*^9, 
   3.826875191639439*^9, 3.826876315865814*^9, 3.826885855349175*^9, 
   3.826887408334052*^9, 3.826888021737323*^9, {3.8268884327120543`*^9, 
   3.8268884403350677`*^9}, 3.8268891873729143`*^9, 3.82688990995967*^9, 
   3.826909572014011*^9, 3.8271460678879757`*^9, 3.827146147946294*^9, 
   3.827205120976234*^9, 3.827218171970996*^9, 3.827220342818698*^9, 
   3.8273928682896442`*^9, 3.82776438663297*^9, 3.8277646251972837`*^9, 
   3.827765676063229*^9, 3.8279263681177263`*^9, 3.8279265306301622`*^9, 
   3.827927861223218*^9, 3.827933560214473*^9, 3.8279338250126877`*^9, 
   3.827984991372908*^9, 3.8280247979246187`*^9, 3.828263110338299*^9, 
   3.828781653959055*^9},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "Out[116]//MatrixForm=",ExpressionUUID->"221c8f53-6cee-4128-82f0-\
5ed11c500cf6"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"HC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Lambda]", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Chi]", ",", "_Real"}], "}"}]}], "}"}], ",", 
     RowBox[{"Evaluate", "@", "HH"}], ",", 
     RowBox[{"Evaluate", "@", "compileOptions"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DH1C", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Lambda]", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Chi]", ",", "_Real"}], "}"}]}], "}"}], ",", 
     RowBox[{"Evaluate", "@", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"H", "[", 
         RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], ",", "\[Lambda]"}], 
       "]"}]}], ",", 
     RowBox[{"Evaluate", "@", "compileOptions"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DH2C", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Lambda]", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Chi]", ",", "_Real"}], "}"}]}], "}"}], ",", 
     RowBox[{"Evaluate", "@", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"H", "[", 
         RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], ",", "\[Chi]"}], 
       "]"}]}], ",", 
     RowBox[{"Evaluate", "@", "compileOptions"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gC", "[", 
   RowBox[{
    RowBox[{"\[Lambda]_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Chi]_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "enNonSort", ",", "eigNonSort", ",", "en", ",", "eig", ",", "eigNon", 
      ",", "g11", ",", "g12", ",", "g22", ",", "M1", ",", "M1T", ",", "M2", 
      ",", "M2T", ",", "endif"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"enNonSort", ",", "eigNonSort"}], "}"}], "=", 
      RowBox[{"Eigensystem", "[", 
       RowBox[{
        RowBox[{"HC", "[", 
         RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], ",", 
        RowBox[{"Method", "\[Rule]", 
         RowBox[{"{", "\"\<Banded\>\"", "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"en", ",", "eig"}], "}"}], "=", 
      RowBox[{"Transpose", "@", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"enNonSort", ",", "eigNonSort"}], "}"}], "]"}], ",", 
         "First"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"M1", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"eig", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
         RowBox[{"DH1C", "[", 
          RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], ".", 
         RowBox[{"eig", "[", 
          RowBox[{"[", "#", "]"}], "]"}]}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"2", ",", "dim"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"M1T", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"eig", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "]"}], ".", 
         RowBox[{"DH1C", "[", 
          RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], ".", 
         RowBox[{"eig", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"2", ",", "dim"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"M2", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"eig", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
         RowBox[{"DH2C", "[", 
          RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], ".", 
         RowBox[{"eig", "[", 
          RowBox[{"[", "#", "]"}], "]"}]}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"2", ",", "dim"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"M2T", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"eig", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "]"}], ".", 
         RowBox[{"DH2C", "[", 
          RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], ".", 
         RowBox[{"eig", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"2", ",", "dim"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"endif", "=", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"en", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "-", 
           RowBox[{"en", "[", 
            RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "2"], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"2", ",", "dim"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"g11", "=", 
      RowBox[{"Re", "@", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"M1", "[", 
             RowBox[{"[", "i", "]"}], "]"}], 
            RowBox[{"M1T", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "/", 
          RowBox[{"endif", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"g12", "=", 
      RowBox[{"Re", "@", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"M1", "[", 
             RowBox[{"[", "i", "]"}], "]"}], 
            RowBox[{"M2T", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "/", 
          RowBox[{"endif", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"g22", "=", 
      RowBox[{"Re", "@", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"M2", "[", 
             RowBox[{"[", "i", "]"}], "]"}], 
            RowBox[{"M2T", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "/", 
          RowBox[{"endif", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"g11", ",", "g12"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"g12", ",", "g22"}], "}"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.8277643165161123`*^9, 3.8277643447076693`*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"d2c31f20-a672-4893-bc61-f0dce85e5116"],

Cell[CellGroupData[{

Cell["Metric tensor", "Section",
 CellChangeTimes->{{3.826016997531725*^9, 3.8260170126284857`*^9}, {
  3.826858988861498*^9, 3.8268589892247562`*^9}, {3.828105500472959*^9, 
  3.8281055018131638`*^9}},ExpressionUUID->"0de33250-380d-4e95-b775-\
fbc32adbc753"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DH1", "[", 
    RowBox[{"\[Lambda]_", ",", "\[Chi]_"}], "]"}], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"H", "[", 
      RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], ",", "\[Lambda]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DH2", "[", 
    RowBox[{"\[Lambda]_", ",", "\[Chi]_"}], "]"}], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"H", "[", 
      RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], ",", "\[Chi]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "[", 
   RowBox[{"\[Lambda]_", ",", "\[Chi]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "g11", ",", "g12", ",", "g22", ",", "energies", ",", "eigenvectors"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"energies", "=", 
      RowBox[{"Eigenvalues", "[", 
       RowBox[{
        RowBox[{"H", "[", 
         RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], ",", 
        RowBox[{"Quartics", "\[Rule]", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"eigenvectors", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"Normalize", ",", 
        RowBox[{"Eigenvectors", "[", 
         RowBox[{"H", "[", 
          RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"g11", "=", 
      RowBox[{"Re", "@", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Conjugate", "[", 
               RowBox[{"eigenvectors", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
              RowBox[{"DH1", "[", 
               RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], ".", 
              RowBox[{"eigenvectors", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Conjugate", "[", 
               RowBox[{"eigenvectors", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], ".", 
              RowBox[{"DH1", "[", 
               RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], ".", 
              RowBox[{"eigenvectors", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], ")"}], "/", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"energies", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{"energies", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "2"]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "dim"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"g12", "=", 
      RowBox[{"Re", "@", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Conjugate", "[", 
              RowBox[{"eigenvectors", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
             RowBox[{"DH1", "[", 
              RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], ".", 
             RowBox[{"eigenvectors", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], 
            RowBox[{
             RowBox[{"Conjugate", "[", 
              RowBox[{"eigenvectors", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], ".", 
             RowBox[{"DH2", "[", 
              RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], ".", 
             RowBox[{"eigenvectors", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}], "/", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"energies", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{"energies", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "2"]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "dim"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"g22", "=", 
      RowBox[{"Re", "@", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Conjugate", "[", 
               RowBox[{"eigenvectors", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
              RowBox[{"DH2", "[", 
               RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], ".", 
              RowBox[{"eigenvectors", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Conjugate", "[", 
               RowBox[{"eigenvectors", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], ".", 
              RowBox[{"DH2", "[", 
               RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], ".", 
              RowBox[{"eigenvectors", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], ")"}], "/", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"energies", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{"energies", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "2"]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "dim"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"g11", ",", "g12"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"g12", ",", "g22"}], "}"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.828106486618957*^9, 3.8281065233099318`*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"11d0cdca-143f-4924-bcf8-a695536997a8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Geodesics", "Section",
 CellChangeTimes->{{3.828105715702194*^9, 
  3.8281057181389008`*^9}},ExpressionUUID->"9622d118-b549-4b85-9bd9-\
cad7b71a60ab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"derPiece", "[", 
    RowBox[{"\[Lambda]_", ",", "\[Chi]_"}], "]"}], "=", 
   RowBox[{"Piecewise", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"14", ",", 
        RowBox[{
         RowBox[{"\[Lambda]", ">", "1"}], "&&", 
         RowBox[{
          RowBox[{"-", "0.4"}], "<", "\[Chi]", "<", "0.4"}]}]}], "}"}], "}"}],
      ",", 
     RowBox[{"Round", "[", 
      RowBox[{"8", "+", 
       FractionBox["10", 
        RowBox[{"0.8", "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"\[Lambda]", "+", 
            FractionBox["1", "2"]}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Abs", "[", "\[Chi]", "]"}], "-", 
            SqrtBox[
             FractionBox["3", "5"]]}], ")"}], "2"]}]]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"derPieceC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Lambda]", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Chi]", ",", "_Real"}], "}"}]}], "}"}], ",", 
     RowBox[{"Evaluate", "@", 
      RowBox[{"derPiece", "[", 
       RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}]}], ",", 
     RowBox[{"Evaluate", "@", "compileOptions"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8281625137182217`*^9, 3.82816265064382*^9}, {
   3.828162706667708*^9, 3.828162772079646*^9}, {3.828162813149061*^9, 
   3.828162829446375*^9}, {3.828162872877102*^9, 3.828163110527845*^9}, {
   3.828163159723246*^9, 3.828163181867581*^9}, {3.8281632524390907`*^9, 
   3.828163267637735*^9}, {3.82816402369713*^9, 3.828164052133852*^9}, {
   3.828168046648798*^9, 3.8281680487569304`*^9}, {3.828168331692933*^9, 
   3.828168333452869*^9}, {3.8281689301005507`*^9, 3.828168964251513*^9}, {
   3.828168997855873*^9, 3.8281691439805202`*^9}, {3.828169430945792*^9, 
   3.8281695076142817`*^9}, {3.8281696401443987`*^9, 3.828169709980744*^9}, {
   3.8283630685306377`*^9, 3.8283630984726467`*^9}, {3.828363322480686*^9, 
   3.828363356683078*^9}, {3.828364648336241*^9, 3.8283646519835377`*^9}, {
   3.828364914280387*^9, 3.828365015235018*^9}, 3.8283650822551327`*^9, {
   3.8283651246825943`*^9, 3.828365128174903*^9}, {3.82842767425753*^9, 
   3.828427687299971*^9}, {3.828699952487369*^9, 3.828699963084197*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"8522bbbf-c353-4ec5-a553-5c33893abfba"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"G1", "[", 
   RowBox[{
    RowBox[{"\[Lambda]_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Chi]_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"derTerms", ",", "c", ",", "l", ",", "dg", ",", "gInv"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"derTerms", "=", 
      RowBox[{"derPieceC", "[", 
       RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dg", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ND", "[", 
         RowBox[{
          RowBox[{"gC", "[", 
           RowBox[{"l", ",", "\[Chi]"}], "]"}], ",", "l", ",", "\[Lambda]", 
          ",", 
          RowBox[{"Terms", "\[Rule]", "derTerms"}]}], "]"}], ",", 
        RowBox[{"ND", "[", 
         RowBox[{
          RowBox[{"gC", "[", 
           RowBox[{"\[Lambda]", ",", "c"}], "]"}], ",", "c", ",", "\[Chi]", 
          ",", 
          RowBox[{"Terms", "\[Rule]", "derTerms"}]}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"gInv", "=", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"Inverse", "[", 
        RowBox[{"gC", "[", 
         RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"gInv", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "\[Nu]"}], "]"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1", ",", "\[Nu]"}], "]"}], "]"}], "+", 
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "\[Nu]", ",", "1"}], "]"}], "]"}], "-", 
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"\[Nu]", ",", "1", ",", "1"}], "]"}], "]"}]}], ")"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"gInv", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "\[Nu]"}], "]"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1", ",", "\[Nu]"}], "]"}], "]"}], "+", 
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "\[Nu]", ",", "2"}], "]"}], "]"}], "-", 
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"\[Nu]", ",", "1", ",", "2"}], "]"}], "]"}]}], ")"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"gInv", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "\[Nu]"}], "]"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2", ",", "\[Nu]"}], "]"}], "]"}], "+", 
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "\[Nu]", ",", "2"}], "]"}], "]"}], "-", 
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"\[Nu]", ",", "2", ",", "2"}], "]"}], "]"}]}], ")"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "1", ",", "2"}], "}"}]}], "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G2", "[", 
   RowBox[{
    RowBox[{"\[Lambda]_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Chi]_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"derTerms", ",", "c", ",", "l", ",", "dg", ",", "gInv"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"derTerms", "=", 
      RowBox[{"derPieceC", "[", 
       RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dg", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ND", "[", 
         RowBox[{
          RowBox[{"gC", "[", 
           RowBox[{"l", ",", "\[Chi]"}], "]"}], ",", "l", ",", "\[Lambda]", 
          ",", 
          RowBox[{"Terms", "\[Rule]", "derTerms"}]}], "]"}], ",", 
        RowBox[{"ND", "[", 
         RowBox[{
          RowBox[{"gC", "[", 
           RowBox[{"\[Lambda]", ",", "c"}], "]"}], ",", "c", ",", "\[Chi]", 
          ",", 
          RowBox[{"Terms", "\[Rule]", "derTerms"}]}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"gInv", "=", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"Inverse", "[", 
        RowBox[{"gC", "[", 
         RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"gInv", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "\[Nu]"}], "]"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1", ",", "\[Nu]"}], "]"}], "]"}], "+", 
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "\[Nu]", ",", "1"}], "]"}], "]"}], "-", 
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"\[Nu]", ",", "1", ",", "1"}], "]"}], "]"}]}], ")"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"gInv", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "\[Nu]"}], "]"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1", ",", "\[Nu]"}], "]"}], "]"}], "+", 
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "\[Nu]", ",", "2"}], "]"}], "]"}], "-", 
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"\[Nu]", ",", "1", ",", "2"}], "]"}], "]"}]}], ")"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"gInv", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "\[Nu]"}], "]"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2", ",", "\[Nu]"}], "]"}], "]"}], "+", 
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "\[Nu]", ",", "2"}], "]"}], "]"}], "-", 
            RowBox[{"dg", "[", 
             RowBox[{"[", 
              RowBox[{"\[Nu]", ",", "2", ",", "2"}], "]"}], "]"}]}], ")"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "1", ",", "2"}], "}"}]}], "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.8281684096707897`*^9, 3.8281684102435493`*^9}, {
   3.82816863655274*^9, 3.828168639196347*^9}, 3.828168795184144*^9, {
   3.828169158563402*^9, 3.8281691586480417`*^9}, 3.8281692865113363`*^9, {
   3.8281694773429203`*^9, 3.828169478499889*^9}},
 CellLabel->
  "In[126]:=",ExpressionUUID->"4c386be8-28fa-4999-b9aa-6ec30adb6120"],

Cell[BoxData[
 RowBox[{
  RowBox[{"geodbg", "=", 
   RowBox[{"DensityPlot", "[", 
    RowBox[{
     RowBox[{"Det", "@", 
      RowBox[{"gC", "[", 
       RowBox[{"\[Lambda]", ",", "\[Chi]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]", ",", 
       RowBox[{"-", "2"}], ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Chi]", ",", 
       RowBox[{"-", "1.5"}], ",", "1.5"}], "}"}], ",", 
     RowBox[{"Evaluate", "@", "densityPlotOptions"}], ",", 
     RowBox[{"ScalingFunctions", "\[Rule]", "\"\<Log10\>\""}], ",", 
     RowBox[{"PlotPoints", "\[Rule]", "100"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.827423583239848*^9, 3.8274237116506987`*^9}, {
   3.8277397548877087`*^9, 3.827739757446381*^9}, 3.8277480310394363`*^9, 
   3.827748273233795*^9, 3.827748408819066*^9, {3.828074416066772*^9, 
   3.828074416184394*^9}, {3.828169789945673*^9, 3.828169806450096*^9}, {
   3.8281741051251793`*^9, 3.828174120473055*^9}, {3.828174211021536*^9, 
   3.82817421543196*^9}, {3.8283547880736847`*^9, 3.828354793860395*^9}, 
   3.828700075864119*^9, {3.828781415944907*^9, 3.828781455704947*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"c58d62cb-33f4-48bc-acab-e0b8cfac0bdc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tmax", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Lambda]", "''"}], "[", "t", "]"}], "+", 
       RowBox[{
        RowBox[{"G1", "[", 
         RowBox[{
          RowBox[{"\[Lambda]", "[", "t", "]"}], ",", 
          RowBox[{"\[Chi]", "[", "t", "]"}]}], "]"}], ".", 
        RowBox[{"{", " ", 
         RowBox[{
          SuperscriptBox[
           RowBox[{
            RowBox[{"\[Lambda]", "'"}], "[", "t", "]"}], "2"], ",", 
          RowBox[{"2", " ", 
           RowBox[{
            RowBox[{"\[Lambda]", "'"}], "[", "t", "]"}], 
           RowBox[{
            RowBox[{"\[Chi]", "'"}], "[", "t", "]"}]}], ",", " ", 
          SuperscriptBox[
           RowBox[{
            RowBox[{"\[Chi]", "'"}], "[", "t", "]"}], "2"]}], "}"}]}]}], 
      "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Chi]", "''"}], "[", "t", "]"}], "+", 
       RowBox[{
        RowBox[{"G2", "[", 
         RowBox[{
          RowBox[{"\[Lambda]", "[", "t", "]"}], ",", 
          RowBox[{"\[Chi]", "[", "t", "]"}]}], "]"}], ".", 
        RowBox[{"{", " ", 
         RowBox[{
          SuperscriptBox[
           RowBox[{
            RowBox[{"\[Lambda]", "'"}], "[", "t", "]"}], "2"], ",", 
          RowBox[{"2", " ", 
           RowBox[{
            RowBox[{"\[Lambda]", "'"}], "[", "t", "]"}], 
           RowBox[{
            RowBox[{"\[Chi]", "'"}], "[", "t", "]"}]}], ",", " ", 
          SuperscriptBox[
           RowBox[{
            RowBox[{"\[Chi]", "'"}], "[", "t", "]"}], "2"]}], "}"}]}]}], 
      "\[Equal]", "0"}]}], "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8287817973607817`*^9, 3.8287817984951344`*^9}},
 Background->RGBColor[
  0.94, 0.88, 0.94],ExpressionUUID->"976d6323-b359-4294-b7c9-85d7500bb713"],

Cell[CellGroupData[{

Cell["Initial value problem", "Subsection",
 CellChangeTimes->{{3.8267141183904753`*^9, 3.826714131060636*^9}, {
  3.8281717193584023`*^9, 
  3.82817172058461*^9}},ExpressionUUID->"b125c60a-fda6-4763-aaea-\
684d05a51cf6"],

Cell["WorkingPrecision = 70 houd be enough (50 was same as 150)", "Text",
 CellChangeTimes->{{3.828498233904443*^9, 
  3.828498262355122*^9}},ExpressionUUID->"d0b211b9-fa74-4d99-b3a8-\
8ce446e76e59"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cauchy", "[", 
    RowBox[{"l1_", ",", "x1_", ",", "l2_", ",", "x2_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Lambda]", "[", "0", "]"}], "\[Equal]", "l1"}], ",", 
     RowBox[{
      RowBox[{"\[Chi]", "[", "0", "]"}], "\[Equal]", "x1"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Lambda]", "'"}], "[", "0", "]"}], "\[Equal]", "l2"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Chi]", "'"}], "[", "0", "]"}], "\[Equal]", "x2"}], ",", 
     RowBox[{"WhenEvent", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Lambda]", "[", "t", "]"}], ">", "4"}], ",", 
         RowBox[{
          RowBox[{"\[Lambda]", "[", "t", "]"}], "<", 
          RowBox[{"-", "2"}]}], ",", 
         RowBox[{
          RowBox[{"-", "1.5"}], ">", 
          RowBox[{"\[Chi]", "[", "t", "]"}], ">", "1.5"}]}], "}"}], ",", 
       "\"\<StopIntegration\>\""}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.826714142343007*^9, {3.826783138223839*^9, 3.826783155541944*^9}, {
   3.827221029456456*^9, 3.827221033960548*^9}, {3.8275053176529617`*^9, 
   3.827505320605082*^9}, {3.827554656113709*^9, 3.827554744870864*^9}, 
   3.8275636485940037`*^9, {3.827644949265959*^9, 3.827644952083428*^9}, {
   3.8276485463194733`*^9, 3.827648547450633*^9}, {3.828700015987832*^9, 
   3.828700029321476*^9}, {3.828700090435289*^9, 3.828700173872473*^9}, {
   3.8287002343577957`*^9, 3.828700234857328*^9}, {3.828700438839793*^9, 
   3.828700446003357*^9}, 3.828715700195239*^9, {3.8287157563761578`*^9, 
   3.828715766016244*^9}, {3.8287158401688147`*^9, 3.828715867427356*^9}},
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[130]:=",ExpressionUUID->"4cb122bf-68f2-4651-93bf-7710044b63cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"solMulti", "=", 
   RowBox[{"Quiet", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"NDSolve", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"eq", ",", 
          RowBox[{"cauchy", "[", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Lambda]", ",", "\[Chi]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "tmax"}], "}"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "2"}], ",", 
        RowBox[{"AccuracyGoal", "\[Rule]", "2"}], ",", 
        RowBox[{"WorkingPrecision", "\[Rule]", "7"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "0", ",", 
        RowBox[{"\[Pi]", "/", "2"}], ",", 
        FractionBox["\[Pi]", "2"]}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8273314202331343`*^9, 3.827331443245042*^9}, {
   3.827331702717484*^9, 3.8273317444290257`*^9}, {3.827331802275642*^9, 
   3.827331803796085*^9}, {3.827332072684825*^9, 3.827332100661479*^9}, 
   3.8273322080802517`*^9, {3.82733226862953*^9, 3.827332289309917*^9}, {
   3.8273324179753723`*^9, 3.8273324338633432`*^9}, {3.827332560994165*^9, 
   3.82733257879165*^9}, {3.827332702498034*^9, 3.827332705889297*^9}, {
   3.8273327408961983`*^9, 3.827332745805008*^9}, {3.8273328010824213`*^9, 
   3.827332812037321*^9}, {3.8273329831577168`*^9, 3.827333013500441*^9}, 
   3.82733470855414*^9, {3.827335119809334*^9, 3.827335151886321*^9}, 
   3.827338484999758*^9, 3.827554566476227*^9, {3.8275546013125467`*^9, 
   3.827554664920298*^9}, {3.82755478122961*^9, 3.8275547972587748`*^9}, {
   3.8275636565884447`*^9, 3.827563659522562*^9}, {3.827644961710328*^9, 
   3.827644967827517*^9}, 3.8276485780803833`*^9, 3.827648636261331*^9, {
   3.8276497255311337`*^9, 3.827649728121642*^9}, {3.8276636097421417`*^9, 
   3.8276636207996893`*^9}, {3.827730500153953*^9, 3.827730523347354*^9}, {
   3.8277305648333693`*^9, 3.827730568555779*^9}, {3.8281544616609583`*^9, 
   3.8281544628698606`*^9}, 3.8281717562960052`*^9, 3.828171801400432*^9, {
   3.828331454312696*^9, 3.8283314607588053`*^9}, 3.828331503847493*^9, {
   3.8287001859070883`*^9, 3.828700224392158*^9}, 3.8287004164765787`*^9, {
   3.828715858053041*^9, 3.828715914840603*^9}, {3.828716095104033*^9, 
   3.8287161452683372`*^9}, {3.828716177771132*^9, 3.828716185930393*^9}, {
   3.828717807150949*^9, 3.8287178456161222`*^9}, {3.828781521290145*^9, 
   3.828781551532618*^9}, {3.828781812030826*^9, 3.828781833966564*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"5f92cacb-37ad-400a-a254-43ecd37907f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"geodInitial", "=", 
   RowBox[{"ParametricPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Lambda]", "[", "t", "]"}], ",", 
         RowBox[{"\[Chi]", "[", "t", "]"}]}], "}"}], "/.", "solMulti"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "tmax"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8287817530089073`*^9, 3.8287817733926773`*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"ef33fb45-62a7-4a9c-aeb0-e1a8c79e6503"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<pg2_2p7.pdf\>\""}], 
   ",", 
   RowBox[{"Show", "[", 
    RowBox[{"geodbg", ",", "geodInitial"}], "]"}], ",", 
   RowBox[{"\"\<AllowRasterization\>\"", "\[Rule]", "True"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "360"}], ",", 
   RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.828781527374865*^9, 3.828781618901731*^9}, {
  3.828781758839602*^9, 3.828781760408318*^9}, {3.828781953191152*^9, 
  3.828781957690173*^9}},
 CellLabel->
  "In[141]:=",ExpressionUUID->"3dbd58cd-76d2-4031-beac-f3ef904e29f5"],

Cell[BoxData["\<\"/home/strelda/Documents/mff/dp/code/pg2_2p7.pdf\"\>"], \
"Output",
 CellChangeTimes->{3.8287817115554237`*^9, 3.828781852514637*^9, 
  3.8287819640903873`*^9},
 CellLabel->
  "Out[141]=",ExpressionUUID->"27f231e2-45bd-4f8c-ab77-79b331958d3f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.82878229837918*^9, 
  3.828782298408187*^9}},ExpressionUUID->"689291b0-efd2-4206-b590-\
9e27de8285e2"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8287841407784147`*^9, 
  3.8287841423424587`*^9}},ExpressionUUID->"28905fcb-13de-415f-83cc-\
0ca7cd2e14c7"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
Evaluator->"local1",
WindowSize->{2686, 1925},
WindowMargins->{{1, Automatic}, {Automatic, 1}},
CellContext->Notebook,
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 220, 4, 70, "Chapter",ExpressionUUID->"d5df468e-12ce-4338-9041-7afd652b4ae3"],
Cell[645, 21, 2551, 60, 147, "Input",ExpressionUUID->"b534aa99-0e08-4714-b452-59481de72866"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3233, 86, 376, 5, 67, "Subtitle",ExpressionUUID->"97a69f8f-14be-40f6-90d1-74a26f8e2eea"],
Cell[3612, 93, 749, 19, 71, "Input",ExpressionUUID->"38ed4e28-b1a5-4013-bf2e-686ec8fc4134"],
Cell[4364, 114, 889, 25, 57, "Input",ExpressionUUID->"b0e155c1-af50-47d1-aab4-f3c3ae1f6939"],
Cell[5256, 141, 5279, 145, 176, "Input",ExpressionUUID->"6fea32da-919a-4123-816b-c6113da0e0eb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10572, 291, 150, 3, 99, "Title",ExpressionUUID->"01f2ec63-811d-4c78-8e8c-7719171f8481"],
Cell[CellGroupData[{
Cell[10747, 298, 4671, 98, 186, "Input",ExpressionUUID->"606f51cf-fb0a-4350-8000-0b2248996519"],
Cell[15421, 398, 4541, 116, 57, "Output",ExpressionUUID->"9733aff7-4dd9-418d-afd6-f86eb698096b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19999, 519, 1371, 29, 71, "Input",ExpressionUUID->"9f1cac35-e1c3-477a-b623-b5e83e436118"],
Cell[21373, 550, 1403, 21, 25, "Print",ExpressionUUID->"1ed8421a-d97b-466a-adee-908ee891ac46"],
Cell[22779, 573, 6852, 145, 169, "Output",ExpressionUUID->"221c8f53-6cee-4128-82f0-5ed11c500cf6"]
}, Open  ]],
Cell[29646, 721, 7169, 207, 393, "Input",ExpressionUUID->"d2c31f20-a672-4893-bc61-f0dce85e5116"],
Cell[CellGroupData[{
Cell[36840, 932, 259, 4, 68, "Section",ExpressionUUID->"0de33250-380d-4e95-b775-fbc32adbc753"],
Cell[37102, 938, 5774, 155, 276, "Input",ExpressionUUID->"11d0cdca-143f-4924-bcf8-a695536997a8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42913, 1098, 156, 3, 68, "Section",ExpressionUUID->"9622d118-b549-4b85-9bd9-cad7b71a60ab"],
Cell[43072, 1103, 2534, 60, 132, "Input",ExpressionUUID->"8522bbbf-c353-4ec5-a553-5c33893abfba"],
Cell[45609, 1165, 7527, 208, 351, "Input",ExpressionUUID->"4c386be8-28fa-4999-b9aa-6ec30adb6120"],
Cell[53139, 1375, 1211, 25, 31, "Input",ExpressionUUID->"c58d62cb-33f4-48bc-acab-e0b8cfac0bdc"],
Cell[54353, 1402, 1978, 55, 168, "Input",ExpressionUUID->"976d6323-b359-4294-b7c9-85d7500bb713"],
Cell[CellGroupData[{
Cell[56356, 1461, 221, 4, 55, "Subsection",ExpressionUUID->"b125c60a-fda6-4763-aaea-684d05a51cf6"],
Cell[56580, 1467, 199, 3, 36, "Text",ExpressionUUID->"d0b211b9-fa74-4d99-b3a8-8ce446e76e59"],
Cell[56782, 1472, 1827, 42, 47, "Input",ExpressionUUID->"4cb122bf-68f2-4651-93bf-7710044b63cc"],
Cell[58612, 1516, 2745, 49, 46, "Input",ExpressionUUID->"5f92cacb-37ad-400a-a254-43ecd37907f0"],
Cell[61360, 1567, 684, 18, 31, "Input",ExpressionUUID->"ef33fb45-62a7-4a9c-aeb0-e1a8c79e6503"],
Cell[CellGroupData[{
Cell[62069, 1589, 663, 15, 31, "Input",ExpressionUUID->"3dbd58cd-76d2-4031-beac-f3ef904e29f5"],
Cell[62735, 1606, 260, 5, 35, "Output",ExpressionUUID->"27f231e2-45bd-4f8c-ab77-79b331958d3f"]
}, Open  ]],
Cell[63010, 1614, 195, 5, 31, "Input",ExpressionUUID->"689291b0-efd2-4206-b590-9e27de8285e2"],
Cell[63208, 1621, 156, 3, 31, "Input",ExpressionUUID->"28905fcb-13de-415f-83cc-0ca7cd2e14c7"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

